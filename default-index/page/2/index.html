<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<!-- 导入jquery -->
<script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-3.5.1.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Htto的小站">
<meta property="og:url" content="http://example.com/default-index/page/2/index.html">
<meta property="og:site_name" content="Htto的小站">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Htto">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/default-index/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Htto的小站</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Htto的小站</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/18/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E5%AE%9A%E7%A7%AF%E5%88%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/a1.jpg">
      <meta itemprop="name" content="Htto">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Htto的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/18/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E5%AE%9A%E7%A7%AF%E5%88%86/" class="post-title-link" itemprop="url">定积分</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-04-18 09:28:18" itemprop="dateCreated datePublished" datetime="2022-04-18T09:28:18+08:00">2022-04-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-15 13:55:05" itemprop="dateModified" datetime="2024-06-15T13:55:05+08:00">2024-06-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">高等数学</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="有关三角函数的定积分">有关三角函数的定积分</h2>
<ol type="1">
<li><p>设<span class="math inline">\(f(x)\)</span>在<span
class="math inline">\([0,1]\)</span>上连续，则<span
class="math inline">\(\displaystyle\int_{0}^{\pi/2} f(\sin
x)=\int_{0}^{\pi/2} f(\cos x)\)</span></p></li>
<li><p><span
class="math inline">\(I_n=\displaystyle\int_{0}^{\pi/2}\sin^n
x=\int_{0}^{\pi/2}\cos^n
x,I_n=\frac{n-1}{n}I_{n-2},I_1=1,I_0=\frac{\pi}{2}\)</span></p></li>
<li><p>设<span class="math inline">\(f(x)\)</span>在<span
class="math inline">\([0,1]\)</span>上连续，则<span
class="math inline">\(\displaystyle\int_{0}^{\pi} f(\sin
x)=2\int_{0}^{\pi/2} f(\sin x)\)</span></p></li>
<li><p>设<span class="math inline">\(f(x)\)</span>在<span
class="math inline">\([0,1]\)</span>上连续，则<span
class="math inline">\(\displaystyle\int_{0}^{\pi} xf(\sin
x)=\frac{\pi}{2}\int_{0}^{\pi/2} f(\sin x)\)</span></p></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/16/ICPC/Contest/21NJ/Crystalfly/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/a1.jpg">
      <meta itemprop="name" content="Htto">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Htto的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/16/ICPC/Contest/21NJ/Crystalfly/" class="post-title-link" itemprop="url">Crystalfly</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-04-16 12:34:08" itemprop="dateCreated datePublished" datetime="2022-04-16T12:34:08+08:00">2022-04-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-15 13:55:05" itemprop="dateModified" datetime="2024-06-15T13:55:05+08:00">2024-06-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/DP/" itemprop="url" rel="index"><span itemprop="name">DP</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="h-crystalfly">H-Crystalfly</h2>
<h3 id="题目大意">题目大意</h3>
<p>给你一颗树，每个节点都有两个值，一个是权值<span
class="math inline">\(a_i\)</span>，还有一个是失效时间<span
class="math inline">\(t_i\)</span>。你一开始在1号节点，如果你在<span
class="math inline">\(t\)</span>时刻走到一个一个点，那么他的所有相邻的点的权值将会在<span
class="math inline">\(t+t_i\)</span>秒末清零。每走到一个点将会采集这个点的权值，问你最多能采集多少权值</p>
<h3 id="解题思路">解题思路</h3>
<p>到达一个节点后，子节点就会立即计时，我们发现<span
class="math inline">\(t_i\)</span>的范围是<span
class="math inline">\(1...3\)</span>我们逐一来考虑<span
class="math inline">\(t_i\)</span>的情况。 * <span
class="math inline">\(t_i=1\)</span>，那么如果走到父节点后不立即走到他的话，他的权值就会立即变为0
* <span class="math inline">\(t_i=2\)</span>，可以发现这种情况和<span
class="math inline">\(t_i=1\)</span>等价，因为你从一个兄弟走到这个节点一定来不及。
* <span
class="math inline">\(t_i=3\)</span>，从父节点出动，如果你第一秒走到一个兄弟节点，第二秒回头，那么第三秒你还来得及回头来获得这个节点的权值。</p>
<p>我们发现节点可能会返回，但是一旦<span
class="math inline">\(u\)</span>返回到他的父节点，那么他的孩子们将会挂掉。我们dp开三维
<span class="math inline">\(f[u][t][0/1]\)</span>,你在<span
class="math inline">\(t\)</span>时刻访问了<span
class="math inline">\(u\)</span>节点，这个时刻是你从访问父节点时刻到当前时刻的差值，最大为4（因为4以上都没什么意义）。
那么我们开始考虑转移。首先我们考虑需要返回的情况，那么孩子们都会挂掉
<span class="math inline">\(f(u,t,1)= a_u[t\le t_u]+\sum\limits_{v\in
sons(u)}{f(v,4,0)}\)</span>
现在我们开始转移不需要返回的状态。分类讨论，容易知道，我们最多保住两个孩子，但是有的时候只保一个会比较优</p>
<ol type="1">
<li>如果我们只保留一个孩子，我们就找到一个孩子权值最大的加上去就行。<span
class="math inline">\(f(u,t,0)\leftarrow f(u,t,1)+max(a_v)\)</span></li>
<li>如果要保留两个孩子，情况会稍微复杂一点，我们第一步可以先挑一个点走，然后返回父节点，第三步走到一个<span
class="math inline">\(t=3\)</span>的节点上。<span
class="math inline">\(f(u,t,0)\leftarrow \max\limits_{v_1,v_2\in
son(u)}{(a_u[t\le
t_u]+f(u,1,1)+f(v_1,1,1)-f(v_1,4,0)+f(v_2,3,0))}\)</span>其中<span
class="math inline">\(T_{v_2}=3\)</span>,我们用一个multiset维护。见代码</li>
</ol>
<p>ps: 第二维发现只有两个情况，选和不选</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; A;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; T;</span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; G;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> dp[maxn][<span class="number">5</span>][<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> p, <span class="type">int</span> t, <span class="type">bool</span> back)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> &amp;ans = dp[u][t][back];</span><br><span class="line">    <span class="keyword">if</span> (dp[u][t][back] != <span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line"></span><br><span class="line">    ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (t &lt;= T[u])</span><br><span class="line">        ans += A[u];</span><br><span class="line">    <span class="comment">// 记录t=3孩子的权值</span></span><br><span class="line">    multiset&lt;<span class="type">int</span>&gt; tab;</span><br><span class="line">    <span class="comment">//[子节点权重,子节点编号]</span></span><br><span class="line">    vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; ch;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> base = ans;</span><br><span class="line">    <span class="comment">// 孩子全部死翘翘的情况</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : G[u])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (v == p)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        ch.<span class="built_in">push_back</span>(&#123;A[v], v&#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (T[v] == <span class="number">3</span>)</span><br><span class="line">            tab.<span class="built_in">insert</span>(A[v]);</span><br><span class="line">        base += <span class="built_in">dfs</span>(v, u, <span class="number">4</span>, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 如果这个节点要返回的话，那么我们所有孩子都会挂掉，我们直接返回。</span></span><br><span class="line">    <span class="keyword">if</span> (back)</span><br><span class="line">        <span class="keyword">return</span> ans = base;</span><br><span class="line">    <span class="comment">// 权值最大的孩子，如果我们不保留两个节点，我们就取权值最大的孩子</span></span><br><span class="line">    <span class="built_in">sort</span>(ch.<span class="built_in">begin</span>(), ch.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 叶子节点</span></span><br><span class="line">    <span class="keyword">if</span> (ch.<span class="built_in">empty</span>())</span><br><span class="line">        <span class="keyword">return</span> ans = base;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 保一个孩子</span></span><br><span class="line">    ans = base + ch.<span class="built_in">back</span>().first;</span><br><span class="line">    <span class="comment">// 没有t=3孩子，那么最多保一个</span></span><br><span class="line">    tab.<span class="built_in">insert</span>(<span class="number">-0x3f3f3f3f3f</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> [w, v] : ch)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (T[v] == <span class="number">3</span>)</span><br><span class="line">            tab.<span class="built_in">erase</span>(tab.<span class="built_in">find</span>(A[v]));</span><br><span class="line">        ans = <span class="built_in">max</span>(ans, base + <span class="built_in">dfs</span>(v, u, <span class="number">1</span>, <span class="literal">true</span>) - <span class="built_in">dfs</span>(v, u, <span class="number">4</span>, <span class="literal">false</span>) + *tab.<span class="built_in">rbegin</span>());</span><br><span class="line">        <span class="keyword">if</span> (T[v] == <span class="number">3</span>)</span><br><span class="line">            tab.<span class="built_in">insert</span>(A[v]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">### AC代码</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    A.<span class="built_in">clear</span>(), T.<span class="built_in">clear</span>(), G.<span class="built_in">clear</span>();</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    A.<span class="built_in">resize</span>(n + <span class="number">1</span>), T.<span class="built_in">resize</span>(n + <span class="number">1</span>), G.<span class="built_in">resize</span>(n + <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">4</span>; j++)</span><br><span class="line">            dp[i][j][<span class="number">0</span>] = dp[i][j][<span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        cin &gt;&gt; A[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        cin &gt;&gt; T[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">        G[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">        G[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="literal">false</span>) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> T;</span><br><span class="line">        cin &gt;&gt; T;</span><br><span class="line">        <span class="keyword">while</span> (T--)</span><br><span class="line">            <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">catch</span> (exception &amp;e)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; e.<span class="built_in">what</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/16/%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7/Latex%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/a1.jpg">
      <meta itemprop="name" content="Htto">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Htto的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/16/%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7/Latex%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">Latex 说明手册</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-04-16 09:28:18" itemprop="dateCreated datePublished" datetime="2022-04-16T09:28:18+08:00">2022-04-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-15 13:55:05" itemprop="dateModified" datetime="2024-06-15T13:55:05+08:00">2024-06-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="基本符号">基本符号</h2>
<p><img
src="https://img-blog.csdn.net/2018041621294865?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1lFTl9DU0RO/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70"
alt="latex1" /> <img
src="https://img-blog.csdn.net/20180416213036844?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1lFTl9DU0RO/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70"
alt="latex2" /> <img
src="https://img-blog.csdn.net/20180416213119987?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1lFTl9DU0RO/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" />
<img
src="https://img-blog.csdn.net/20180416213126857?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1lFTl9DU0RO/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" /></p>
<h2 id="一些技巧">一些技巧</h2>
<ul>
<li>行内公式变行间公式格式 displaystyle</li>
<li>跨行公式</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/16/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E5%A4%9A%E9%87%8D%E7%A7%AF%E5%88%86%E9%A2%98%E7%9B%AE%E9%9B%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/a1.jpg">
      <meta itemprop="name" content="Htto">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Htto的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/16/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E5%A4%9A%E9%87%8D%E7%A7%AF%E5%88%86%E9%A2%98%E7%9B%AE%E9%9B%86/" class="post-title-link" itemprop="url">多重积分题目集</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-04-16 09:28:18" itemprop="dateCreated datePublished" datetime="2022-04-16T09:28:18+08:00">2022-04-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-15 13:55:05" itemprop="dateModified" datetime="2024-06-15T13:55:05+08:00">2024-06-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">高等数学</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="二重积分的计算">二重积分的计算</h2>
<ol type="1">
<li><p>[讲义P186]设<span
class="math inline">\(f(u)\)</span>连续，区域<span
class="math inline">\(D\)</span>由<span
class="math inline">\(y=x^3,x=-1,y=1\)</span>围城，计算<span
class="math inline">\(\displaystyle
I=\iint\limits_dx(1+yf(x^2+y^2)d\sigma\)</span></p></li>
<li><p>[讲义P187]设<span class="math inline">\(D\)</span>为<span
class="math inline">\(xOy\)</span>平面 <span class="math display">\[
f(x)=
\begin{cases}
a,0\le x \le 1,\\
0,其他
\end{cases}
\]</span> 计算<span
class="math inline">\(\displaystyle\iint\limits_D{f(x)f(y-x)dx
dy}\)</span></p></li>
</ol>
<h2 id="汤家凤1800入门">汤家凤1800入门</h2>
<ol type="1">
<li>[P41]. 设区域<span class="math inline">\(D\)</span>由<span
class="math inline">\(y=\sqrt(2x-x^2)\)</span>与<span
class="math inline">\(x\)</span>轴围成，<span
class="math inline">\(\displaystyle
f(x,y)=xy-\iint\limits_D{f(x,y)dxdy}\)</span>，则<span
class="math inline">\(f(x,y)\)</span></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/15/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/a1.jpg">
      <meta itemprop="name" content="Htto">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Htto的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/15/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0/" class="post-title-link" itemprop="url">三角函数公式</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-04-15 12:34:08" itemprop="dateCreated datePublished" datetime="2022-04-15T12:34:08+08:00">2022-04-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-15 13:55:05" itemprop="dateModified" datetime="2024-06-15T13:55:05+08:00">2024-06-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">高等数学</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E5%9F%BA%E6%9C%AC/" itemprop="url" rel="index"><span itemprop="name">基本</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="基本公式">基本公式</h2>
<p><span class="math inline">\(1+\tan ^2 \alpha=\sec^2
\alpha\)</span></p>
<p><span class="math inline">\(1+\cot^2 \alpha = csc^2
\alpha\)</span></p>
<p><span class="math inline">\(\sin {2\alpha} = 2\sin \alpha \cos
\alpha\)</span></p>
<p><span class="math inline">\(\cos {2\alpha} = \cos^2 \alpha - \sin^2
\alpha = 2\cos^2 \alpha - 1=1-2\sin^2 \alpha\)</span></p>
<p><span class="math inline">\(\sin^2 \alpha =
\dfrac{1-\cos{2\alpha}}{2}\)</span></p>
<p><span class="math inline">\(\cos^2 \alpha =
\dfrac{1+\cos{2\alpha}}{2}\)</span></p>
<p><span class="math inline">\(\sin (\alpha +
\beta)=\sin\alpha\cos\beta+\cos\alpha\sin\beta\)</span></p>
<p><span
class="math inline">\(\cos(\alpha+\beta)=\cos\alpha\cos\beta-\sin\alpha
\sin \beta\)</span></p>
<p><span
class="math inline">\(\tan(\alpha+\beta)=\dfrac{\tan\alpha+\tan\beta}{1-tan\alpha\cdot\tan\beta}\)</span></p>
<h2 id="积分公式">积分公式</h2>
<p><span class="math inline">\(\displaystyle\int\limits\tan x=-\ln|\cos
x|+C\)</span></p>
<p><span class="math inline">\(\displaystyle\int\limits\cot x=\ln|\sin
x|+C\)</span></p>
<p><span class="math inline">\(\displaystyle\int\limits\sec x=\ln|\sec
x+\tan x|+C\)</span></p>
<p><span class="math inline">\(\displaystyle\int\limits\csc x=\ln|\csc
x-\cot x|+C\)</span></p>
<p><span class="math inline">\(\displaystyle\int\limits\sec^2 x=\tan
x+C\)</span></p>
<p><span class="math inline">\(\displaystyle\int\limits\csc^2 x=-\cot
x+C\)</span></p>
<p><span class="math inline">\(\displaystyle\int\limits\sec x\tan x=\sec
x+C\)</span></p>
<p><span class="math inline">\(\displaystyle\int\limits\csc x\cot
x=-\csc x+C\)</span></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/13/ICPC/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/a1.jpg">
      <meta itemprop="name" content="Htto">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Htto的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/13/ICPC/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/" class="post-title-link" itemprop="url">组合数学</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-04-13 12:34:08" itemprop="dateCreated datePublished" datetime="2022-04-13T12:34:08+08:00">2022-04-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-15 13:55:05" itemprop="dateModified" datetime="2024-06-15T13:55:05+08:00">2024-06-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/%E6%95%B0%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">数学</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>[toc]</p>
<h2 id="组合基本公式">组合基本公式</h2>
<p><span class="math display">\[
\binom{n}{k}=\frac{n!}{(n-k)!\cdot k!}
\]</span></p>
<p><span class="math display">\[
\binom{n}{k}=\binom{n-1}{k-1}+\binom{n-1}{k}
\]</span> <span class="math display">\[
\binom{n}{k}=\binom{n}{n-k},n\ge 0, k\in Z
\]</span> <span class="math display">\[
\binom{n}{k}=\frac{r}{k}\binom{n-1}{k-1}, k\neq 0
\]</span></p>
<h2 id="组合数的计算">组合数的计算</h2>
<ol type="1">
<li><p>使用内置的<span class="math inline">\(\Gamma\)</span>函数 <span
class="math display">\[
\Gamma(s)=\int_o^{+\infty}{x^{s-1}e^{-x}dx}
\]</span> 在整数点上满足 <span class="math display">\[
\Gamma(n+1)=n!
\]</span> 所以可以这样求</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">C</span><span class="params">(ll n,ll m)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (ll)<span class="built_in">round</span>(<span class="built_in">tgamma</span>(n+<span class="number">1</span>)/<span class="built_in">tgamma</span>(m+<span class="number">1</span>)/<span class="built_in">tgamma</span>(n-m+<span class="number">1</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>使用杨辉三角形递推</p></li>
<li><p>预处理逆元</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> F[maxn];</span><br><span class="line"><span class="type">int</span> IF[maxn];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!n)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> ans = <span class="built_in">qpow</span>(x, n / <span class="number">2</span>);</span><br><span class="line">    ans = ans * ans % mod;</span><br><span class="line">    <span class="keyword">if</span> (n &amp; <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ans * x % mod;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    IF[<span class="number">0</span>] = F[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; maxn; i++)</span><br><span class="line">        F[i] = F[i - <span class="number">1</span>] * i % mod;</span><br><span class="line">    IF[maxn - <span class="number">1</span>] = <span class="built_in">qpow</span>(F[maxn - <span class="number">1</span>], mod - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = maxn - <span class="number">2</span>; i &gt;= <span class="number">1</span>; i--)</span><br><span class="line">        IF[i] = IF[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % mod;</span><br><span class="line">    IF[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">C</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (k &lt; <span class="number">0</span> || k &gt; n)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> F[n] * IF[k] % mod * IF[n - k] % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="经典问题">经典问题</h2>
<h3 id="插空法">插空法</h3>
<p>对于不相邻问题，我们可以使用插空法比如</p>
<p>一共有n个位置，m棵树，两棵树之间要有空位，每棵树都不一样。问你排列方法。首先<span
class="math inline">\(m\)</span>棵树要占<span
class="math inline">\(m\)</span>个坑，这样就剩下了<span
class="math inline">\(n-m\)</span>个坑，剩下的坑会形成<span
class="math inline">\(n-m+1\)</span>个空白，我们的树就可以插到空白里像这样_
0 _ 0 _ 0 _ 所以结果就是<span
class="math inline">\(A_{n-m+1}^m\)</span></p>
<h3 id="插板法">插板法</h3>
<p>使用条件 * 相同的物品分给不同的东西 * 每个东西至少有一个</p>
<blockquote>
<p><strong>9个相同的物品放到3个盒子里，每个盒子至少一个物品问有多少种放法</strong></p>
</blockquote>
<p>考虑插板法，9个物品之间(不算两边)可以形成8个空隙，两个板子可以把物品分为三块，所以考虑插板，方案数为<span
class="math inline">\(\binom{8}{2}\)</span>。 泛化一下就是<span
class="math inline">\(n\)</span>个物体，分给<span
class="math inline">\(m\)</span>个容器，每个容器至少1个方案数就是<span
class="math inline">\(\binom{n-1}{m-1}\)</span></p>
<ul>
<li><p>如果每个盒子要放<span
class="math inline">\(k\)</span>个，那么可以当<span
class="math inline">\((k-1)\cdot m\)</span>个已经已经放好了</p></li>
<li><p>如果每个盒子不要求放的个数，我们可以补<span
class="math inline">\(m\)</span>个球先放进去结果就是<span
class="math inline">\(\binom{n+m-1}{m-1}\)</span></p></li>
</ul>
<h3 id="错排问题">错排问题</h3>
<p>给定<span class="math inline">\(n\)</span>元素集合<span
class="math inline">\(X\)</span>,它的每一个元素都有一个特定的位置,而现在要求求出集合<span
class="math inline">\(X\)</span>的排列中没有一个元素在它指定位置上的排列的数目。</p>
<p>比如当<span class="math inline">\(n=2\)</span>时有一组<span
class="math inline">\(\{2,1\}\)</span></p>
<p>首先给出公式<span
class="math inline">\(D_n=(n-1)\cdot(D_{n-1}+D_{n-2})\)</span></p>
<p>简单证明(非严格)，假如我们有<span
class="math inline">\(n\)</span>个数，我们选择第一个数<span
class="math inline">\(1\)</span>和2配对，这样2可以和1配对，剩下了方案就是<span
class="math inline">\(D_{n-2}\)</span>，如果2不和1位置陪对，那么可以把1位置当2（反正他们不可能在一起）这样方案数就是<span
class="math inline">\(D_{n-1}\)</span>，很显然有<span
class="math inline">\((n-1)\)</span>个平行的情况，所以公式是这个。</p>
<h2 id="容斥原理">容斥原理</h2>
<p>容斥原理公式 <span class="math display">\[
\left|
\bigcup\limits_{i=1}^n{A_i}\right|=\sum_{i=1}^n|A_i|-\sum_{i,j:1\le i\lt
j\le n}{|A_i\cap A_j|}+\sum_{i,j,k:\;1\le i \lt j \le k \le n}{|A_i\cap
A_j \cap A_k|}-...+(-1)^{n-1}|A_1 \cap ... \cap A_n|
\]</span></p>
<p>大家都知道，如何计算容斥呢。如果我们能快速计算交集的个数，那么可以用二进制枚举所有子集，然后根据元素个数判断是该加上还是减去。（一般我们算的是不合法的方案数，那么就反过来，根据物品种类的数量奇数加，偶数减）</p>
<h3 id="硬币购物">硬币购物</h3>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1450">硬币购物</a></p>
<h4 id="题目大意">题目大意</h4>
<p>共有 4 种硬币。面值分别为<span
class="math inline">\(c_1,c_2,c_3,c_4\)</span>。某人去商店买东西，去了
<span class="math inline">\(n\)</span> 次，对于每次购买，他带了<span
class="math inline">\(d_1,d_2,d_3,d_4\)</span>枚 <span
class="math inline">\(4\)</span> 种硬币，想购买 <span
class="math inline">\(s\)</span>的价值的东西。请问每次有多少种付款方法。</p>
<p><span class="math inline">\(1\le c_i,d_i,s \le 10^5, 1\le n \le
1000\)</span></p>
<h4 id="分析">分析</h4>
<p>用多重背包会超时，我们可以先算出完全背包 <span
class="math inline">\(dp[i]\)</span>代表有购买<span
class="math inline">\(i\)</span>元物品的方案数，<span
class="math inline">\(dp[s-C[i]*(D[i]+1)]\)</span>就是第<span
class="math inline">\(i\)</span>种硬币不合法的方案数。相当于你第<span
class="math inline">\(i\)</span>种硬币已经用了<span
class="math inline">\(D[i]+1\)</span>枚，那就必然不合法了。</p>
<h4 id="参考代码">参考代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxm = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> C[<span class="number">5</span>];</span><br><span class="line"><span class="type">int</span> D[<span class="number">5</span>];</span><br><span class="line"><span class="type">int</span> dp[maxm];</span><br><span class="line"><span class="type">int</span> s;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">4</span>; i++)</span><br><span class="line">        cin &gt;&gt; C[i];</span><br><span class="line">    dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = C[i]; j &lt; maxm; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            dp[j] += dp[j - C[i]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">while</span> (n--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">4</span>; i++)</span><br><span class="line">            cin &gt;&gt; D[i];</span><br><span class="line">        cin &gt;&gt; s;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; (<span class="number">1</span> &lt;&lt; <span class="number">4</span>); k++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> t = s;</span><br><span class="line">            <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (k &gt;&gt; i &amp; <span class="number">1</span>)</span><br><span class="line">                    t -= C[i+<span class="number">1</span>] * (D[<span class="number">1</span>+i] + <span class="number">1</span>), cnt++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (t &lt; <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (cnt &amp; <span class="number">1</span>)</span><br><span class="line">                ans -= dp[t];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                ans += dp[t];</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="hdu6397">HDU6397</h3>
<p><a
target="_blank" rel="noopener" href="http://acm.hdu.edu.cn/showproblem.php?pid=6397">补题链接</a></p>
<h4 id="题目大意-1">题目大意</h4>
<p>给定<span class="math inline">\(n,m,k\)</span>，要求个<span
class="math inline">\(m\)</span>个格子填数，使每个数在<span
class="math inline">\([0,n-1]\)</span>范围内，且他们的和为<span
class="math inline">\(k\)</span>。</p>
<h4 id="分析-1">分析</h4>
<p>如果不考虑<span
class="math inline">\([0,n-1]\)</span>这个范围我们就可以使用插板法，相当于<span
class="math inline">\(k\)</span>物体放到<span
class="math inline">\(m\)</span>个格子，但是不要求每个格子有物体方案数就是<span
class="math inline">\(\binom{k+m-1}{m-1}\)</span>。那么考虑限制呢，我们可以使用容斥，比如<strong>至少</strong>要求<span
class="math inline">\(i\)</span>个数大于等于<span
class="math inline">\(n\)</span>（或者要求<span
class="math inline">\(i\)</span>个数大于等于<span
class="math inline">\(n\)</span>其他数无所谓），那么我们先在那<span
class="math inline">\(i\)</span>个格子中放<span
class="math inline">\(n\)</span>个物品，这些格子就一定大于<span
class="math inline">\(n-1\)</span>满足了条件，剩下了<span
class="math inline">\(k-n\cdot i\)</span>个物品，方案数就是<span
class="math inline">\(\binom{k-n\cdot
i+m-1}{m-1}\)</span>，至少要求<span
class="math inline">\(i\)</span>个数大于等于<span
class="math inline">\(n\)</span>的方案数就是 <span
class="math display">\[
\binom{m}{i}\binom{k-n\cdot i+m-1}{m-1}
\]</span> 然后奇数减，偶数加即可</p>
<h4 id="参加代码">参加代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class="line">    <span class="type">int</span> ans = <span class="built_in">C</span>(k + m - <span class="number">1</span>, m - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; k - n * i + m - <span class="number">1</span> &gt;= m - <span class="number">1</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> cur = <span class="built_in">C</span>(m, i) * <span class="built_in">C</span>(k - n * i + m - <span class="number">1</span>, m - <span class="number">1</span>) % mod;</span><br><span class="line">        <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ans = (ans - cur) % mod;</span><br><span class="line">            ans = (ans % mod + mod) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            ans = (ans + cur) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ccpc威海2021-m.810975">CCPC威海2021 M.810975</h3>
<p><a
target="_blank" rel="noopener" href="https://codeforces.com/gym/357355/problem/M">补题链接</a></p>
<h4 id="题目大意-2">题目大意</h4>
<p>问你有多少个01串满足:长度为<span
class="math inline">\(n\)</span>，有<span
class="math inline">\(m\)</span>个1，最长连续的1长度恰好为<span
class="math inline">\(k\)</span></p>
<h4 id="分析-2">分析</h4>
<p>我们定义<span
class="math inline">\(f(x)\)</span>为最长连续1的长度<strong>小于等于</strong><span
class="math inline">\(x\)</span>的方案数。</p>
<p>答案就是<span class="math inline">\(f(k)-f(k-1)\)</span></p>
<p>现在考虑计算<span class="math inline">\(f(k)\)</span>发现计算<span
class="math inline">\(f(k)\)</span>就是上一题的方法，<span
class="math inline">\(n-m\)</span>个<span
class="math inline">\(0\)</span>留了<span
class="math inline">\(n-m+1\)</span>个空（包含两边），这些空就可以看作盒子数量，然后1的和看做物品数量总和，其中每个盒子最多放<span
class="math inline">\([0,k]\)</span>个物品。</p>
<h2 id="康托展开">康托展开</h2>
<h3 id="基本概念">基本概念</h3>
<p>康托展开主要对一个排列哈希，求一个排列是第几大，具体公式为 <span
class="math display">\[
\sum\limits_{i=1}^{n-1}{A_i(n-i)!}
\]</span> 其中<span class="math inline">\(A_i\)</span>为<span
class="math inline">\(\sum\limits_{j=i+1}^n{[a_j\lt a_i]}\)</span></p>
<p>其中<span class="math inline">\(A_i\)</span>我们可以用<span
class="math inline">\(O(n^2)\)</span>暴力算，也可以用树状数组算。</p>
<h3 id="逆康托展开">逆康托展开</h3>
<p>类似对进制转换，<span class="math inline">\(A[i]=
x/(n-i)!\)</span>然后取余继续循环。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    F[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        F[i] = F[i - <span class="number">1</span>] * i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">cantor</span><span class="params">(<span class="type">const</span> vector&lt;<span class="type">int</span>&gt; &amp;vec)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">B</span><span class="params">(vec.size())</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i + <span class="number">1</span>; j &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            B[i] += A[j] &lt; A[i];</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ans += B[i] * F[n - i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">decantor</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x--;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">ans</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">A</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        A[i] = x / F[n - i];</span><br><span class="line">        x %= F[n - i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">P</span><span class="params">(n+<span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="built_in">iota</span>(P.<span class="built_in">begin</span>() + <span class="number">1</span>, P.<span class="built_in">end</span>(), <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ans[i] = P[A[i] + <span class="number">1</span>];</span><br><span class="line">        P.<span class="built_in">erase</span>(<span class="built_in">lower_bound</span>(P.<span class="built_in">begin</span>() + <span class="number">1</span>, P.<span class="built_in">end</span>(), ans[i]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="卡特兰数">卡特兰数</h2>
<p>给定一个数<span class="math inline">\(N\)</span>，我们要计算由<span
class="math inline">\(2N\)</span>字符能组成多少不同的括号序列。</p>
<p>结论:<span class="math inline">\(\displaystyle
f(n)=\sum_\limits{i=1}^n{f(i-1)\cdot
f(n-i)}\)</span>，我们可以这样构造<span
class="math inline">\((p1)p2\)</span> 。不停的扩大<span
class="math inline">\(p1\)</span>的大小，然后使用乘法原理和加法原理即可获得该公式。我们计算这个数列朴素的时间复杂度是<span
class="math inline">\(O(n^2)\)</span>，而其实这个数列有个专门的名字叫做<strong>卡特兰数</strong>。</p>
<p>一些卡特兰数的公式：</p>
<ul>
<li><p><span class="math inline">\(\displaystyle C_n=\frac{1}{n+1}\binom
{2n} {n}=\binom {2n} {n}-\binom {2n} {n-1}\)</span></p></li>
<li><p><span class="math inline">\(C_0=C_1=1,\displaystyle
C_n=\frac{4n-2}{n+1}C_{n-1}\)</span></p></li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> C[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> ans = <span class="built_in">qpow</span>(x, n / <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> (n &amp; <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ans * x % mod * ans % mod;</span><br><span class="line">    <span class="keyword">return</span> ans * ans % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">inv</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">qpow</span>(x, mod - <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    C[<span class="number">0</span>] = C[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt; maxn; i++)</span><br><span class="line">        C[i] = (<span class="number">4</span> * i - <span class="number">2</span>) * <span class="built_in">inv</span>(i + <span class="number">1</span>) % mod * C[i - <span class="number">1</span>] % mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/06/10/ICPC/dp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/a1.jpg">
      <meta itemprop="name" content="Htto">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Htto的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/06/10/ICPC/dp/" class="post-title-link" itemprop="url">DP入门</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-06-10 20:00:00" itemprop="dateCreated datePublished" datetime="2021-06-10T20:00:00+08:00">2021-06-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-15 13:55:05" itemprop="dateModified" datetime="2024-06-15T13:55:05+08:00">2024-06-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/DP/" itemprop="url" rel="index"><span itemprop="name">DP</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>[TOC]</p>
<h2 id="dp入门">DP入门</h2>
<h3 id="摆花优化">摆花优化</h3>
<p>普通摆花我们时间复杂度是<span
class="math inline">\(O(nm^2)\)</span>，其实我们可以对这个大大的求和符号进行优化。洛谷的题解我找了半天居然没有介绍这个优化，还是在白书上看见的</p>
<p><span
class="math inline">\(f(i,j)=\sum\limits_{k=0}^{a_i}{f(i-1,j-k)}=f(i-1,j)+f(i-1,j-1)...+f(i-1,j-a_i)\)</span></p>
<p>我们观察到</p>
<p><span
class="math inline">\(f(i,j-1)=\sum\limits_{k=0}^{a_i}{f(i-1,j-k-1)}=f(i-1,j-1)+f(i-1,j-2)...+f(i-1,j-a_i)+f(i-1,j-1-a_i)\)</span></p>
<p>就这样我们得到了：</p>
<p><span
class="math inline">\(f(i,j)=f(i,j-1)+f(i-1.j)-f(i-1,j-1-a_i)\)</span></p>
<p>同样你还可以滚动数组啥的</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">1e4</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod=<span class="number">1000007</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="type">int</span> f[<span class="number">1005</span>][maxn];</span><br><span class="line"><span class="type">int</span> A[maxn];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        cin&gt;&gt;A[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=n;i++)</span><br><span class="line">        f[i][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=m;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(j<span class="number">-1</span>-A[i]&gt;=<span class="number">0</span>)</span><br><span class="line">                f[i][j]=f[i][j<span class="number">-1</span>]+f[i<span class="number">-1</span>][j]-f[i<span class="number">-1</span>][j<span class="number">-1</span>-A[i]];</span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                f[i][j]=f[i][j<span class="number">-1</span>]+f[i<span class="number">-1</span>][j];</span><br><span class="line">            f[i][j]=(f[i][j]%mod+mod)%mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;f[n][m];</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="lis优化">LIS优化</h3>
<p>我们上次介绍的最长上升子序列，状态转移方程是:</p>
<p><span class="math display">\[
f[i]=max(f[j]+1,1\le j\lt i\;and\;f[i]&gt;f[j])
\]</span></p>
<p>它的时间复杂度是<span
class="math inline">\(O(N^2)\)</span>的，其实我们有一个更快速的方法。使用lower_bound。</p>
<h3 id="coins">Coins</h3>
<p>我们来看一道很像摆花的一道题，多重部分和问题 (<a
target="_blank" rel="noopener" href="http://poj.org/problem?id=1742">POJ1742 -- Coins</a>)
，有n种不同大小的数字<span
class="math inline">\(a_i\)</span>，每种各<span
class="math inline">\(m_i\)</span>个，判断是否可以从这些数字之中选出若干使他们和恰好为K。这题十分类似于摆花。想想该怎么做?</p>
<p>这里我们的状态表示为<span
class="math inline">\(f(i,j)\)</span>，考虑前<span
class="math inline">\(i\)</span>种硬币，刚好加出<span
class="math inline">\(j\)</span>元，第<span
class="math inline">\(i\)</span>种硬币最多还能剩下多少枚。</p>
<h4 id="ac代码">AC代码:</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">105</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxm = <span class="number">100005</span>;</span><br><span class="line"><span class="type">int</span> A[maxn];</span><br><span class="line"><span class="type">int</span> C[maxn];</span><br><span class="line"><span class="type">int</span> f[<span class="number">2</span>][maxm];</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">-1</span>, <span class="built_in">sizeof</span>(f));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, A + i);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, C + i);</span><br><span class="line">    <span class="type">int</span> cur = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// cur^1 是我们即将使用到的上一行</span></span><br><span class="line">    <span class="comment">// 显然第一种硬币加到0元还剩C[1]枚，所以f[前一行][0]初始化为0才能触发第一个if</span></span><br><span class="line">    f[cur][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cur ^= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= m; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 只是用前 i-1种就能加出，那么第i种硬币无需使用</span></span><br><span class="line">            <span class="keyword">if</span> (f[cur ^ <span class="number">1</span>][j] &gt;= <span class="number">0</span>)</span><br><span class="line">                f[cur][j] = C[i];</span><br><span class="line">            <span class="comment">// 那我们就先用掉一枚看看，如果还是没法加成j，我们就放弃了，因为你f[cur][j-A[i]]会帮你算完用2枚能不能....</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (j - A[i] &gt;= <span class="number">0</span> &amp;&amp; f[cur][j - A[i]] &gt;= <span class="number">0</span>)</span><br><span class="line">                f[cur][j] = f[cur][j - A[i]] - <span class="number">1</span>;</span><br><span class="line">            <span class="comment">// 加不成我们就记录为-1，不能是0，因为0的话可能是刚好全用完.</span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                f[cur][j] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (f[cur][i] != <span class="number">-1</span>)</span><br><span class="line">            cnt++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, cnt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m) &amp;&amp; n &amp;&amp; m)</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="划分数"><a
target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2386"><strong>划分数</strong></a></h3>
<p>有n个无区别的物品，将他们划分成不超过m组，求出划分方法。</p>
<p>样例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">输入:</span><br><span class="line">4 3</span><br><span class="line">输出:</span><br><span class="line">4</span><br><span class="line">(1+1+2,1+3,2+2,4)</span><br></pre></td></tr></table></figure>
<p>我们要设计出状态转移方程让他不重复不遗漏的计数。一个显然的方程</p>
<p>​ <span
class="math display">\[f(i,j):将i划分为不超过j组的方案\]</span></p>
<p>​ <span
class="math display">\[f(i,j)=\sum\limits_{k=0}^j{f(i-1,j-k)}\]</span></p>
<p>这样的方程会将1+2+1和2+1+1当成两种方案。出现了重复。怎么才能保证不重复不遗漏呢?</p>
<p>我们可以把每组当成盘子，我们要摆东西在上面，我们发现<span
class="math inline">\(i\)</span>个盘子随意摆放可以分成 <span
class="math inline">\(i\)</span>个盘子都要用到的数量加上前<span
class="math inline">\(i-1\)</span>个盘子随意使用的方案数，这两个状态一定不重叠。那么我们该如何每个盘子都用到呢，可以每个盘子都先放一个还剩下<span
class="math inline">\(j-i\)</span>个物品可以随意摆放。状态转移方程 <span
class="math display">\[
f(i,j)=f(i,j-i)+f(i-1,j)
\]</span></p>
<h3 id="p1280-尼克的任务">P1280 尼克的任务</h3>
<h4 id="题目大意">题目大意</h4>
<p>你一天要在公司呆上n分钟，你会有k个任务需要完成，每个任务都有一个到达时间和持续时间，如果一个任务来了，你是空闲状态，则你必须接其中一个任务。问你最大摸鱼时间。同一个时刻可能会有多个任务！！</p>
<p>这题很很显然的状态是时间<span class="math inline">\(t\)</span>。</p>
<p>而这里任务是强制的，到了必须接其中一个，除非你在忙。所以我们只要一个t就好了</p>
<p><span
class="math inline">\(f(t)\)</span>表示从t秒开始最大获得的空闲时间。or
从1到t秒能获得空闲时间?</p>
<h4 id="转移方程">转移方程</h4>
<p><span
class="math inline">\(f(t)\)</span>:从t开始最多有多少空闲时间，t分钟时你是空闲状态
<span class="math display">\[
f(t)=\begin{cases}
1+f(t+1) ; free\\
max(f(j)) ;have\\
\end{cases}
\]</span></p>
<h3 id="多重背包">多重背包</h3>
<p>前面我们介绍了0-1背包，和完全背包，多重背包是这两个背包的结合，给定每个物件的数量限制，不想0-1背包限制为1和完全背包无限制。我们来看一道题，<a
target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1833">背包综合训练</a></p>
<p>我们可以将多重背包拆分。如果有一种背包能用cnt次，显然的方法是一个一个拆分，将其变成cnt个背包，每个背包只能用一次，这样我们就转化为0-1背包问题了，但是这样做显然很低效，我们还可以考虑二进制拆分。将其拆分为<span
class="math inline">\(1,2,4...2^{n-1},res\)</span> ，<span
class="math inline">\(res\)</span>是cnt减去前面那个公比为2的等比数列的和<strong>且不为<span
class="math inline">\(2^n\)</span></strong>。</p>
<p>你会发现拆分的数列中选取一个子序列可以表示从<span
class="math inline">\([0,cnt]\)</span>中的所有整数，显然从<span
class="math inline">\([0,2^n-1]\)</span>的整数都可以很轻松的表示出来。我们观察它去除<em>res</em>的等比数列，它可以当成无符号数编码，最大是<span
class="math inline">\(11111...\)</span> <span
class="math inline">\(n\)</span>个<span class="math inline">\(1\)</span>
最小是<span class="math inline">\(00000...\)</span><span
class="math inline">\(n\)</span>个0。如果要表示<span
class="math inline">\([2^n,cnt]\)</span>之间的数呢，这部分数可以写成<span
class="math inline">\(cnt-k\)</span>,就是我们去除整个集合的某些数，而k也可以通过前面的等比数列表示，只不过这次我们是不选他们。这样<span
class="math inline">\(cnt-k\)</span>可以表示到<span
class="math inline">\(cnt-2^n+1\)</span>，而这个数一定小于等于<span
class="math inline">\(2^n-1\)</span>，反证 <span class="math display">\[
\begin{align}
cnt-2^n+1 &amp; \gt 2^n-1\\
cnt &amp;\ge 2^{n+1}-1 \\
\end{align}
\]</span> 如果<span
class="math inline">\(cnt=2^{n+1}-1\)</span>的话，他就可以表示出<span
class="math inline">\(1,2,3...2^{n-1},2^n,0\)</span>了。所以通过二进制拆分可以表示出所有的组合。</p>
<h4 id="ac代码-1">AC代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> T, N;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get_interval</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> h1, m1, h2, m2;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d:%d %d:%d&quot;</span>, &amp;h1, &amp;m1, &amp;h2, &amp;m2);</span><br><span class="line">    <span class="type">int</span> t1 = h1 * <span class="number">60</span> + m1, t2 = h2 * <span class="number">60</span> + m2;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">abs</span>(t2 - t1);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> f[<span class="number">1005</span>] = &#123;<span class="number">-1</span>&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">F</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> cost, v, cnt;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> F &amp;f) <span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> v / cost;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; arr[<span class="number">10005</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">input</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    T = <span class="built_in">get_interval</span>();</span><br><span class="line">    cin &gt;&gt; N;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= N; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b, c;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;</span><br><span class="line">        arr[i] = &#123;a, b, c&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">split</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; vec;</span><br><span class="line">    <span class="type">int</span> a=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(p&gt;=a)</span><br><span class="line">    &#123;</span><br><span class="line">        vec.<span class="built_in">push_back</span>(a);</span><br><span class="line">        p-=a;</span><br><span class="line">        a*=<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(p)</span><br><span class="line">        vec.<span class="built_in">push_back</span>(p);</span><br><span class="line">    <span class="keyword">return</span> vec;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    f[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= N; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (arr[i].cnt == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> t = arr[i].cost; t &lt;= T; t++)</span><br><span class="line">                f[t] = <span class="built_in">max</span>(f[t], f[t - arr[i].cost] + arr[i].v);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">auto</span> vec=<span class="built_in">split</span>(arr[i].cnt);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = vec.<span class="built_in">size</span>()<span class="number">-1</span>; k &gt;=<span class="number">0</span>; k--)</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> t = T; t &gt;= vec[k]*arr[i].cost; t--)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// 这里使用一维的，如果使用滚动数组要小心一点哦。</span></span><br><span class="line">                    f[t] = <span class="built_in">max</span>(f[t], f[t - vec[k]*arr[i].cost] + vec[k]*arr[i].v);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f[T];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">input</span>();</span><br><span class="line">    std::cout &lt;&lt; <span class="built_in">solve</span>() &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="cf1513c-add-one">CF1513C: Add One</h3>
<h4 id="题目大意-1">题目大意</h4>
<p>给你一个数字，这个数字每秒钟每个数位会加上1，问一个数<span
class="math inline">\(n\)</span>过了<span
class="math inline">\(m\)</span>秒会有几位。以9为例</p>
<p>1秒10， 2秒21，3秒32，4秒43，5秒54...9秒98，10秒109 11 秒，2110</p>
<p>9过了4秒会有4位</p>
<p>结果要对<span class="math inline">\(10^9+7\)</span>取模</p>
<h4 id="解题思路">解题思路</h4>
<p>我们很容易发现每个数位都是独立的不会相互影响。这样我们可以想到一个简单的dp</p>
<p><span class="math inline">\(f(i,t)\)</span>:<span
class="math inline">\(i,(i\le10)\)</span>经过<span
class="math inline">\(t\)</span>秒会有几位。如果<span
class="math inline">\(i+t&lt;10,f(i,t)=1\)</span>，如果<span
class="math inline">\(i+t&gt;=10\)</span>，考虑我们刚好变成10的时候，我们时间还有<span
class="math inline">\(t+i-10\)</span>那么状态转移方程就是<span
class="math inline">\(f(i,t)=f(1,i+t-10)+f(0,i+t-10)\)</span>。</p>
<h4 id="ac代码-2">AC代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxm = <span class="number">2e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> f[<span class="number">10</span>][maxm];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">        f[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; maxm; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">            <span class="keyword">if</span> (i + j &lt; <span class="number">10</span>)</span><br><span class="line">                f[i][j] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                f[i][j] = (f[<span class="number">0</span>][i + j - <span class="number">10</span>] + f[<span class="number">1</span>][i + j - <span class="number">10</span>]) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    <span class="type">int</span> kase;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;kase);</span><br><span class="line">    <span class="keyword">while</span> (kase--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> n, m;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">        <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (n)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> i = n % <span class="number">10</span>;</span><br><span class="line">            n /= <span class="number">10</span>;</span><br><span class="line">            res = (res + f[i][m]) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; res &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="前缀和差分">前缀和&amp;&amp;差分</h2>
<p>如果给你一个数列，让你快速求出很多区间的和 <span
class="math display">\[
\begin{align}
\sum\limits_{i=l}^r{a_i}
\end{align}
\]</span></p>
<p>这里他可能询问好多组区间和，如果用传统的一个for循环累加时间复杂度为<span
class="math inline">\(O(nm)\)</span>，会TLE。</p>
<h3 id="一维前缀和">一维前缀和</h3>
<p><span class="math display">\[
\begin{align}
令S_i &amp;=\sum\limits_{k=1}^i{a_i} \\
\sum\limits_{i=l}^r{a_i}&amp;=S_r-S_{l-1}\\
\end {align}
\]</span></p>
<p>这样我们维护<span
class="math inline">\(S_i\)</span>就可以用一个减法快速求区间和了。</p>
<h3 id="二维前缀和">二维前缀和</h3>
<p>现在我们拓展到二维，给你一个矩阵，让你求从<span
class="math inline">\((x_0,y_0)到(x_1,y_1)\)</span>所有元素的和。 <span
class="math display">\[
\left[
\begin{array}{}
    1 &amp; 2 &amp; 3\\
    4 &amp; 5 &amp; 6\\
    7 &amp; 8 &amp; 9\\
\end{array}
\right]
\]</span></p>
<p><span class="math display">\[
f(i,j)=f(i-1,j)+f(i,j-1)-f(i-1,j-1)+A(i,j)
\]</span></p>
<h3 id="差分">差分</h3>
<p>如果要对区间频繁进行修改我们可以差分，比如对<span
class="math inline">\([l,r]\)</span>的数都加上一个值<span
class="math inline">\(x\)</span>, 可以设置差分数组<span
class="math inline">\(a_l+=x,a_{r+1}-=x\)</span>，这样求</p>
<h2 id="树形dp">树形dp</h2>
<p>首先你要学会建树，树形dp主要要多练啦，这里给几个我的几道题目笔记</p>
<ul>
<li><a href="/2022/04/16/ICPC/Contest/21NJ/Crystalfly/" title="Crystalfly">Crystalfly</a></li>
</ul>
<h2 id="区间dp">区间DP</h2>
<p>区间DP即要从区间方面考虑状态转移，区间DP常常会出现环形，对环形的处理也有一点小小的技巧。</p>
<h3 id="环形处理">环形处理</h3>
<h4 id="题目大意-2">题目大意</h4>
<p><a
target="_blank" rel="noopener" href="http://oj.merdog.cn/problem/1005">死机后的小健健被骗买了山寨项链 -
题目 - YCITOJ (merdog.cn)</a></p>
<p>给你一串数，这些数串成一串项链，让你求得其中一个连续的一部分，使得其和最大，输出最大和。注意这是一个环，我们常常使用双倍数组来处理环。</p>
<h3 id="p1880石子合并">P1880：石子合并</h3>
<h4 id="题目大意-3">题目大意</h4>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1880">题目传送门</a></p>
<p>给你<span
class="math inline">\(N\)</span>堆石子，这些石子环形相连，开始每个石子就是一个堆，每个堆上有个数，堆可以两两合并，两堆合并成一堆，就会获得两堆之和的分数。问你最大得分和最小得分。</p>
<p>输入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">4</span><br><span class="line">4 5 9 4</span><br></pre></td></tr></table></figure>
<p>输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">43</span><br><span class="line">54</span><br></pre></td></tr></table></figure>
<ol type="1">
<li><p>5-9合并 变成了 4 14 4 得14分</p></li>
<li><p>4-14合并变成了 18 4 得32分</p></li>
<li><p>18-4合并变成了 22 得54分。最高分54分，最低分同理。</p></li>
</ol>
<h4 id="分析">分析</h4>
<p>我们可以先不考虑环形情况，先把他们当作“线性的"那么我们设计状态转移方程</p>
<p><span class="math inline">\(f(i,j)\)</span>：从第<span
class="math inline">\(i\)</span>个石子加到第<span
class="math inline">\(j\)</span>个石子最多能得到多少分。</p>
<p>注意区间dp一般首先枚举的是区间长度，然后再枚举起始位置。状态转移方程。
<span class="math display">\[
f(i,j)=max\left(f(i,x)+f(x+1,j)+\sum\limits_{i\le k \le j}{a_k}\right)
\]</span> 对于环形，我们需要进行环处理</p>
<h4 id="ac代码-3">AC代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">205</span>;</span><br><span class="line"><span class="type">int</span> A[maxn];</span><br><span class="line"><span class="type">int</span> f[maxn][maxn];</span><br><span class="line"><span class="type">int</span> f2[maxn][maxn];</span><br><span class="line"><span class="type">int</span> S[maxn];</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> S[j] - S[i - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; A[i];</span><br><span class="line">        A[i + n] = A[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">2</span> * n; i++)</span><br><span class="line">        S[i] = S[i - <span class="number">1</span>] + A[i];</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> res2 = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">2</span>; k &lt;= n; k++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i + k - <span class="number">1</span> &lt;= <span class="number">2</span> * n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> j = i + k - <span class="number">1</span>;</span><br><span class="line">            f2[i][j] = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> x = i; x + <span class="number">1</span> &lt;= j; x++)</span><br><span class="line">            &#123;</span><br><span class="line">                f[i][j] = <span class="built_in">max</span>(f[i][j], f[i][x] + f[x + <span class="number">1</span>][j] + <span class="built_in">sum</span>(i, j));</span><br><span class="line">                f2[i][j] = <span class="built_in">min</span>(f2[i][j], f2[i][x] + f2[x + <span class="number">1</span>][j] + <span class="built_in">sum</span>(i, j));</span><br><span class="line">                res = <span class="built_in">max</span>(res, f[i][j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        res2=<span class="built_in">min</span>(res2,f2[i][i+n<span class="number">-1</span>]);</span><br><span class="line">    cout &lt;&lt; res2 &lt;&lt; endl</span><br><span class="line">         &lt;&lt; res &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="p3146-248g">P3146: 248G</h3>
<h4 id="题目大意-4">题目大意</h4>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3146">题目传送门</a></p>
<p>给你一串数，你可以合并两个相邻的数，合并后的数为这两个数原本的值+1，比如2-2合并就变成了3，问你合并后的最大数是多少。</p>
<h4 id="分析-1">分析</h4>
<p>区间dp状态转移方程当然是从区间考虑啦，这题其实和上题的思路差不多。状态转移方程根据题目来就行
<span class="math display">\[
f(i,j)=max(f(i,x)+f(x+1,j)\&amp;\&amp;f(i,x)==f(x+1,j))
\]</span></p>
<h4 id="ac代码-4">AC代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">250</span>;</span><br><span class="line"><span class="type">int</span> A[maxn];</span><br><span class="line"><span class="comment">// 0 left 1 right</span></span><br><span class="line"><span class="type">int</span> f[maxn][maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cin&gt;&gt;A[i];</span><br><span class="line">        f[i][i]=A[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>;k&lt;=n;k++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i+k<span class="number">-1</span>&lt;=n;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> j=i+k<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> x=i;x+<span class="number">1</span>&lt;=j;x++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(f[i][x]==f[x+<span class="number">1</span>][j] &amp;&amp; f[i][x]!=<span class="number">0</span>)</span><br><span class="line">                    f[i][j]=<span class="built_in">max</span>(f[i][j],f[i][x]+<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            res=<span class="built_in">max</span>(res,f[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    cout&lt;&lt;res&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="关路灯">关路灯</h3>
<h4 id="题目大意-5">题目大意</h4>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1220">P1220 关路灯 - 洛谷
| 计算机科学教育新生态 (luogu.com.cn)</a></p>
<p>有<span
class="math inline">\(n\)</span>盏路灯，分布在一个一维坐标系上，每盏路灯功率都不一样，位置也都不一样。</p>
<p>现在你要关掉所有路灯，已知你步行速度为<span
class="math inline">\(1m/s\)</span>,按开关的时间忽略不计。输出你关闭所有路灯所消耗的最小功耗。</p>
<p><strong>输入</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span> <span class="number">3</span></span><br><span class="line"><span class="number">2</span> <span class="number">10</span></span><br><span class="line"><span class="number">3</span> <span class="number">20</span></span><br><span class="line"><span class="number">5</span> <span class="number">20</span></span><br><span class="line"><span class="number">6</span> <span class="number">30</span></span><br><span class="line"><span class="number">8</span> <span class="number">10</span></span><br></pre></td></tr></table></figure>
<p><strong>输出</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">270</span>  </span><br></pre></td></tr></table></figure>
<h4 id="解题思路-1">解题思路</h4>
<p>左右端点区间考虑</p>
<p><span class="math inline">\(f(i,j,0)\)</span>表示从<span
class="math inline">\([i,j]\)</span>的路灯都已经熄灭，你在左边也就是<span
class="math inline">\(i\)</span>位置</p>
<p><span class="math inline">\(f(i,j,1)\)</span> 表示从<span
class="math inline">\([i,j]\)</span>的路灯都已经熄灭，你在右边也就是<span
class="math inline">\(j\)</span>位置</p>
<p>画个图分情况转移即可。</p>
<h4 id="ac代码-5">AC代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">55</span>;</span><br><span class="line"><span class="type">int</span> n, c;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Light</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> p;</span><br><span class="line">    <span class="type">int</span> w;</span><br><span class="line">&#125; A[maxn];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> f[maxn][maxn][<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> S[maxn];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">cost</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (A[j].p - A[i].p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; c;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">0x3f</span>, <span class="built_in">sizeof</span>(f));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        cin &gt;&gt; A[i].p &gt;&gt; A[i].w;</span><br><span class="line">    f[c][c][<span class="number">0</span>] = f[c][c][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        S[i] = S[i - <span class="number">1</span>] + A[i].w;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">2</span>; k &lt;= n; k++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i + k - <span class="number">1</span> &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> j = i + k - <span class="number">1</span>;</span><br><span class="line">            f[i][j][<span class="number">0</span>] = <span class="built_in">min</span>(f[i + <span class="number">1</span>][j][<span class="number">0</span>] + <span class="built_in">cost</span>(i, i + <span class="number">1</span>) * (S[n] - S[j] + S[i]), f[i + <span class="number">1</span>][j][<span class="number">1</span>] + <span class="built_in">cost</span>(i, j) * (S[n] - S[j] + S[i]));</span><br><span class="line">            f[i][j][<span class="number">1</span>] = <span class="built_in">min</span>(f[i][j - <span class="number">1</span>][<span class="number">1</span>] + <span class="built_in">cost</span>(j - <span class="number">1</span>, j) * (S[n] - S[j - <span class="number">1</span>] + S[i - <span class="number">1</span>]), f[i][j - <span class="number">1</span>][<span class="number">0</span>] + <span class="built_in">cost</span>(i, j) * (S[n] - S[j - <span class="number">1</span>] + S[i - <span class="number">1</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">min</span>(f[<span class="number">1</span>][n][<span class="number">0</span>], f[<span class="number">1</span>][n][<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="合唱队">合唱队</h3>
<h4 id="题目大意-6">题目大意</h4>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3205">题目传送门</a></p>
<p>给你一个数组(队形)，让你用一下规则对该数列重新排序。</p>
<ul>
<li><span class="math inline">\(a_1\)</span>直接放入新数组</li>
<li><span class="math inline">\(a_i &gt; a_{i-1}\)</span>，将<span
class="math inline">\(a_i\)</span>新插入新数组末尾，否则插入新数组之前。</li>
</ul>
<p>新数组我们成为理想队形。</p>
<p>现在给你（新数组）理想队形，让你求出有多少初始数组能形成该理想队形。</p>
<h4 id="解题思路-2">解题思路</h4>
<p>这题和上次类似，都是从区间两端考虑。</p>
<p>对于理想队形的子段<span class="math inline">\([l,r]\)</span>的解<span
class="math inline">\(f(l,r)\)</span>，因为无法确定初始队形最后一个元素在左边还是右边。那么我们转移到更长的父区间时就无法进行比较，那我们就再加一个状态，记录初始队形最后一个元素加在了左边还是右边即可。然后按照题意转移即可</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">19650827</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> A[maxn];</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> f[maxn][maxn][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; A[i];</span><br><span class="line">        f[i][i][<span class="number">0</span>]  = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">2</span>; k &lt;= n; k++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i + k - <span class="number">1</span> &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> j = i + k - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (A[i] &lt; A[i + <span class="number">1</span>])</span><br><span class="line">                f[i][j][<span class="number">0</span>] += f[i + <span class="number">1</span>][j][<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">if</span> (A[i] &lt; A[j])</span><br><span class="line">                f[i][j][<span class="number">0</span>] += f[i + <span class="number">1</span>][j][<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span> (A[j] &gt; A[i])</span><br><span class="line">                f[i][j][<span class="number">1</span>] += f[i][j - <span class="number">1</span>][<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">if</span> (A[j] &gt; A[j - <span class="number">1</span>])</span><br><span class="line">                f[i][j][<span class="number">1</span>] += f[i][j - <span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">            </span><br><span class="line">            f[i][j][<span class="number">0</span>] %= mod;</span><br><span class="line">            f[i][j][<span class="number">1</span>] %= mod;</span><br><span class="line">        &#125;</span><br><span class="line">    cout &lt;&lt; (f[<span class="number">1</span>][n][<span class="number">0</span>] + f[<span class="number">1</span>][n][<span class="number">1</span>]) % mod &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="数位dp">数位DP</h2>
<h3 id="不要六二"><a
target="_blank" rel="noopener" href="http://acm.hdu.edu.cn/showproblem.php?pid=2089">不要六二</a></h3>
<h4 id="题目大意-7">题目大意：</h4>
<p>如果一个数中出现了4或者62连在一起，我们成为它为不吉利的数，否则为吉利的数</p>
<p>选出从n到m中吉利数的数量。</p>
<h4 id="解题思路-3">解题思路:</h4>
<p>这类满足某种条件的数字的数量可以尝试使用数位DP，假如n=1, m=5432</p>
<p>我们发现1xxxx,
2xxx和3xxx的吉利数量是一样的，我们可以把它当作同一个状态。</p>
<p>而5xxx却不是因为5它后面一位最多只能取到4，所以我们需要做限制，如果被限定了，下面一个数位只能取到我们输入的数位。</p>
<p>数位DP是一个记忆化搜索大概像这样</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> pos,<span class="type">int</span> last,<span class="type">bool</span> limit)</span></span>;</span><br></pre></td></tr></table></figure>
<p><strong>pos</strong>: 是当前处理的数位的位置</p>
<p><strong>last:</strong>上一个数位的值</p>
<p><strong>limit</strong>: 当前pos是否被限制</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> A[<span class="number">8</span>], cnt, dp[<span class="number">8</span>][<span class="number">12</span>][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> pos, <span class="type">int</span> last, <span class="type">bool</span> limit)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> &amp;ans = dp[pos][last][limit];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (pos == cnt)</span><br><span class="line">        <span class="keyword">return</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (ans != <span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line"></span><br><span class="line">    ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> v = <span class="number">0</span>; v &lt;= (limit ? A[pos] : <span class="number">9</span>); v++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (last == <span class="number">6</span> &amp;&amp; v == <span class="number">2</span> || v == <span class="number">4</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        ans += <span class="built_in">dfs</span>(pos + <span class="number">1</span>, v, limit &amp;&amp; v == A[pos]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这一题让你求出从n到m之间的符合条件的数，而这个dfs只能求出从1到n，我们可以将两个都求一下如果<span
class="math inline">\(f(n)\)</span>表示从1到n符合条件的数，最后就是求<span
class="math inline">\(f(m)-f(n-1)\)</span></p>
<h4 id="ac代码-6">AC代码:</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> A[<span class="number">8</span>], cnt, dp[<span class="number">8</span>][<span class="number">12</span>][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> pos, <span class="type">int</span> last, <span class="type">bool</span> limit)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> &amp;ans = dp[pos][last][limit];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (pos == cnt)</span><br><span class="line">        <span class="keyword">return</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (ans != <span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line"></span><br><span class="line">    ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> v = <span class="number">0</span>; v &lt;= (limit ? A[pos] : <span class="number">9</span>); v++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (last == <span class="number">6</span> &amp;&amp; v == <span class="number">2</span> || v == <span class="number">4</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        ans += <span class="built_in">dfs</span>(pos + <span class="number">1</span>, v, limit &amp;&amp; v == A[pos]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">-1</span>, <span class="built_in">sizeof</span>(dp));</span><br><span class="line">    <span class="built_in">memset</span>(A, <span class="number">0</span>, <span class="built_in">sizeof</span>(A));</span><br><span class="line">    <span class="keyword">while</span> (x)</span><br><span class="line">        A[cnt++] = x % <span class="number">10</span>, x /= <span class="number">10</span>;</span><br><span class="line">    <span class="built_in">reverse</span>(A, A + cnt);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">dfs</span>(<span class="number">0</span>, <span class="number">11</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> x, y;</span><br><span class="line">    <span class="keyword">while</span> (cin &gt;&gt; x &gt;&gt; y &amp;&amp; (x || y))</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="built_in">f</span>(y) - <span class="built_in">f</span>(x - <span class="number">1</span>) &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="数字计数"><a
href="%5BP2602%20%5BZJOI2010%5D数字计数%20-%20洛谷%20%7C%20计算机科学教育新生态%20(luogu.com.cn)%5D(https://www.luogu.com.cn/problem/P2602)">数字计数</a></h3>
<h4 id="题目大意-8">题目大意:</h4>
<p>给定两个正整数 <em>a</em> 和 <em>b</em>，求在 <span
class="math inline">\([a,b]\)</span>
中的所有整数中，每个数码(digit)各出现了多少次。</p>
<h4 id="解题思路-4">解题思路:</h4>
<p>这一题我们思路和上面一题类似，对于每个数字我们都单独跑一下dfs，要计算0时可以有前导0比如0001，他有3个前导0（我们存数位从高位存到低位），不应该计入结果，所以我们我们还需要引入一个lead，来标记这是不是前导零，处理方法和limit
差不多，如果还没遇到过其他数位lead为true，否则，lead为false。如果当前要计算的数字不是0，lead一开始就设为false</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> digit;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> pos, <span class="type">int</span> dcnt, <span class="type">bool</span> limit, <span class="type">bool</span> lead)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (pos == cnt)</span><br><span class="line">        <span class="keyword">return</span> dcnt;</span><br><span class="line">    <span class="type">int</span> &amp;ans = dp[pos][dcnt][limit][lead];</span><br><span class="line">    <span class="keyword">if</span> (ans != <span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> v = <span class="number">0</span>; v &lt;= (limit ? A[pos] : <span class="number">9</span>); v++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (v == <span class="number">0</span> &amp;&amp; lead)</span><br><span class="line">            ans += <span class="built_in">dfs</span>(pos + <span class="number">1</span>, dcnt, limit &amp;&amp; v == A[pos], lead);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            ans += <span class="built_in">dfs</span>(pos + <span class="number">1</span>, dcnt + (v == digit), limit &amp;&amp; v == A[pos], <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>digit</strong>: 我们当前要计算的数字出现了多少次</p>
<p>代码应该挺清晰的吧。</p>
<h4 id="ac-代码">AC 代码:</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">22</span>;</span><br><span class="line"><span class="type">int</span> A[maxn], cnt, dp[maxn][<span class="number">12</span>][<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> digit;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> pos, <span class="type">int</span> dcnt, <span class="type">bool</span> limit, <span class="type">bool</span> lead)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (pos == cnt)</span><br><span class="line">        <span class="keyword">return</span> dcnt;</span><br><span class="line">    <span class="type">int</span> &amp;ans = dp[pos][dcnt][limit][lead];</span><br><span class="line">    <span class="keyword">if</span> (ans != <span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> v = <span class="number">0</span>; v &lt;= (limit ? A[pos] : <span class="number">9</span>); v++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (v == <span class="number">0</span> &amp;&amp; lead)</span><br><span class="line">            ans += <span class="built_in">dfs</span>(pos + <span class="number">1</span>, dcnt, limit &amp;&amp; v == A[pos], lead);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            ans += <span class="built_in">dfs</span>(pos + <span class="number">1</span>, dcnt + (v == digit), limit &amp;&amp; v == A[pos], <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">-1</span>, <span class="built_in">sizeof</span>(dp));</span><br><span class="line">    <span class="built_in">memset</span>(A, <span class="number">0</span>, <span class="built_in">sizeof</span>(A));</span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (x)</span><br><span class="line">        A[cnt++] = x % <span class="number">10</span>, x /= <span class="number">10</span>;</span><br><span class="line">    <span class="built_in">reverse</span>(A, A + cnt);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">dfs</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="literal">true</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> x, y;</span><br><span class="line">    cin &gt;&gt; x &gt;&gt; y;</span><br><span class="line">    <span class="keyword">for</span> (digit = <span class="number">0</span>; digit &lt;= <span class="number">9</span>; digit++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> l = <span class="built_in">f</span>(x<span class="number">-1</span>),r=<span class="built_in">f</span>(y);</span><br><span class="line">        cout&lt;&lt;r-l&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="最大异或之和"><a
href="%5BProblem%20-%20276D%20-%20Codeforces%5D(https://codeforces.com/problemset/problem/276/D)">最大异或之和</a></h3>
<h4 id="题目大意-9">题目大意:</h4>
<p>从<span class="math inline">\([l,r]\)</span>中选出一对数<span
class="math inline">\((x,y)\)</span>，使得<span
class="math inline">\(x\oplus y\)</span>的值最大。</p>
<h4 id="解题思路-5">解题思路:</h4>
<p>数位DP不仅可以求数字计数类问题，也可以解决很多二进制按位运算问题。</p>
<p>这题有道很显然的贪心，只要每位贪心每位凑出0-1就行。用数位dp的话就从高位到低位依次考虑。</p>
<p>一般数位dp都有两个limit, limitl , limit
r但是之前的问题因为是计数问题可以用<span
class="math inline">\(f(r)-f(l-1)\)</span>所有我们只用到了一个limit，而这一题，我们不能通过上面简单的相减得到结果。</p>
<p>正确的方法是对于每个数都整个limitl,limitr 这样我们就有4个limit</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> p, <span class="type">bool</span> l1, <span class="type">bool</span> r1, <span class="type">bool</span> l2, <span class="type">bool</span> r2)</span></span>;</span><br></pre></td></tr></table></figure>
<p>其他方法和上面的题目差不多，只不过这个需要二重循环，枚举两个数的p数位，然后异或，取最大的一个。</p>
<h4 id="ac代码-7">AC代码:</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">65</span>;</span><br><span class="line"><span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> L[maxn], R[maxn];</span><br><span class="line"><span class="type">int</span> dp[maxn][<span class="number">2</span>][<span class="number">2</span>][<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> p, <span class="type">bool</span> l1, <span class="type">bool</span> r1, <span class="type">bool</span> l2, <span class="type">bool</span> r2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p == cnt)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> &amp;ans = dp[p][l1][r1][l2][r2];</span><br><span class="line">    <span class="keyword">if</span> (ans != <span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = (l1 ? L[p] : <span class="number">0</span>); i &lt;= (r1 ? R[p] : <span class="number">1</span>); i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = (l2 ? L[p] : <span class="number">0</span>); j &lt;= (r2 ? R[p] : <span class="number">1</span>); j++)</span><br><span class="line">        &#123;</span><br><span class="line">            ans = <span class="built_in">max</span>(ans, ((i ^ j) &lt;&lt; (cnt - p<span class="number">-1</span>)) +</span><br><span class="line">                               <span class="built_in">dfs</span>(p + <span class="number">1</span>, l1 &amp;&amp; i == L[p], r1 &amp;&amp; i == R[p], l2 &amp;&amp; j == L[p], r2 &amp;&amp; j == R[p]));</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> cnt1 = <span class="number">0</span>, cnt2 = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">-1</span>, <span class="built_in">sizeof</span>(dp));</span><br><span class="line">    <span class="built_in">memset</span>(L, <span class="number">0</span>, <span class="built_in">sizeof</span>(L));</span><br><span class="line">    <span class="built_in">memset</span>(R, <span class="number">0</span>, <span class="built_in">sizeof</span>(R));</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> x, y;</span><br><span class="line">    cin &gt;&gt; x &gt;&gt; y;</span><br><span class="line">    <span class="keyword">while</span> (x)</span><br><span class="line">        L[cnt1++] = x &amp; <span class="number">1</span>, x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">        R[cnt2++] = y &amp; <span class="number">1</span>, y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    cnt = <span class="built_in">max</span>(cnt1, cnt2);</span><br><span class="line">    <span class="built_in">reverse</span>(L, L + cnt);</span><br><span class="line">    <span class="built_in">reverse</span>(R, R + cnt);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">dfs</span>(<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">f</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="sum-of-log"><a
target="_blank" rel="noopener" href="https://ac.nowcoder.com/acm/contest/9925/C"><em>Sum of
log</em></a></h3>
<p>该题来自第45届ICPC上海C题</p>
<h4 id="题目大意-10">题目大意:</h4>
<p>给定两个非负整数<span class="math inline">\(X\)</span>,<span
class="math inline">\(Y\)</span>计算 <span class="math display">\[
\sum\limits_{i=0}^X{\sum\limits_{j=[i=0]}^Y{[i\&amp;j=0]\lfloor\log_2{(i+j)+1)}\rfloor}}
\]</span></p>
<ul>
<li>&amp; 指的是按位与</li>
<li><span class="math inline">\([A]\)</span>：当A为真时<span
class="math inline">\([A]\)</span>=1，否则为0</li>
</ul>
<h4 id="解题思路-6">解题思路:</h4>
<p>这题应该很裸吧，和上面一题，关于二进制，我们观察<span
class="math inline">\(log_2(i+j)+1\)</span> 等于<span
class="math inline">\(i,j\)</span>位数中较大的加一，因为当<span
class="math inline">\(i\&amp;j=0\)</span>时两个数0-1是错开的，<span
class="math inline">\(i+j\le11111...\)</span>这样的话，状态应该为:</p>
<ul>
<li>pos: 当前的数位</li>
<li>max_bit: 最高位的位置</li>
<li>limit1:对第一个数限制</li>
<li>limit2:对第二个数限制</li>
</ul>
<p>如果全是前导0的话可以通过max_bit 和pos的关系确定</p>
<p><strong>TLE代码</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">31</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> cnt;</span><br><span class="line"><span class="type">int</span> dp[maxn][maxn][<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> X[maxn], Y[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> pos, <span class="type">int</span> max_bit, <span class="type">int</span> limit1, <span class="type">int</span> limit2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (max_bit == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (pos == cnt)</span><br><span class="line">        <span class="keyword">return</span> max_bit;</span><br><span class="line">    <span class="type">int</span> &amp;ret = dp[pos][max_bit][limit1][limit2];</span><br><span class="line">    <span class="keyword">if</span> (ret != <span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    ret = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> ex = (limit1 ? X[pos] : <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> ey = (limit2 ? Y[pos] : <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= ex; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= ey; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (i + j == <span class="number">0</span> &amp;&amp; max_bit == cnt-pos)</span><br><span class="line">            &#123;</span><br><span class="line">                ret += <span class="built_in">dfs</span>(pos + <span class="number">1</span>, max_bit - <span class="number">1</span>, limit1 &amp;&amp; (i == X[pos]), limit2 &amp;&amp; (j == Y[pos]));</span><br><span class="line">                ret %= mod;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> ((i &amp; j) == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                ret += <span class="built_in">dfs</span>(pos + <span class="number">1</span>, max_bit, limit1 &amp;&amp; (i == X[pos]), limit2 &amp;&amp; (j == Y[pos]));</span><br><span class="line">                ret %= mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> x_cnt = <span class="number">0</span>, y_cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">-1</span>, <span class="built_in">sizeof</span>(dp));</span><br><span class="line">    <span class="built_in">memset</span>(X, <span class="number">0</span>, <span class="built_in">sizeof</span>(X));</span><br><span class="line">    <span class="built_in">memset</span>(Y, <span class="number">0</span>, <span class="built_in">sizeof</span>(Y));</span><br><span class="line">    <span class="keyword">while</span> (x)</span><br><span class="line">        X[x_cnt++] = x &amp; <span class="number">1</span>, x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">        Y[y_cnt++] = y &amp; <span class="number">1</span>, y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    cnt = <span class="built_in">max</span>(x_cnt, y_cnt);</span><br><span class="line">    <span class="built_in">reverse</span>(X, X + cnt);</span><br><span class="line">    <span class="built_in">reverse</span>(Y, Y + cnt);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">dfs</span>(<span class="number">0</span>, cnt, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> T;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x, y;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">f</span>(x, y));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其实我感觉这个数据量勉强能过吗，然后就TLE
QWQ，还好没打上海赛区，不然就是队友数量-3，时间
-2h。更优的方法是压缩掉一维max_bit，然后记录方案数，用一个全局变量累加方案数*最高位。</p>
<p>当从前导0变成非0的时候，我们记录一下计数，这样才能保证不重复</p>
<h4 id="ac代码-8">AC代码:</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">31</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> cnt;</span><br><span class="line"><span class="type">int</span> dp[maxn][maxn][<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> X[maxn], Y[maxn];</span><br><span class="line"><span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> pos, <span class="type">int</span> limit1, <span class="type">int</span> limit2, <span class="type">bool</span> zero)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (pos == cnt)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> &amp;ret = dp[pos][limit1][limit2][zero];</span><br><span class="line">    <span class="keyword">if</span> (ret != <span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    ret = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> ex = (limit1 ? X[pos] : <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> ey = (limit2 ? Y[pos] : <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= ex; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= ey; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &amp; j)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (zero &amp;&amp; (i | j))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> tmp = <span class="built_in">dfs</span>(pos + <span class="number">1</span>, limit1 &amp;&amp; (i == ex), limit2 &amp;&amp; (j == ey), <span class="literal">false</span>);</span><br><span class="line">                tot = (tot + tmp) % mod;</span><br><span class="line">                ret = (ret + tmp) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                ret += <span class="built_in">dfs</span>(pos + <span class="number">1</span>, limit1 &amp;&amp; (i == ex), limit2 &amp;&amp; (j == ey), zero &amp;&amp; (i + j == <span class="number">0</span>));</span><br><span class="line">                ret %= mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = (ans+ (tot * (cnt - pos))) % mod;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">    ans = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> x_cnt = <span class="number">0</span>, y_cnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">-1</span>, <span class="built_in">sizeof</span>(dp));</span><br><span class="line">    <span class="built_in">memset</span>(X, <span class="number">0</span>, <span class="built_in">sizeof</span>(X));</span><br><span class="line">    <span class="built_in">memset</span>(Y, <span class="number">0</span>, <span class="built_in">sizeof</span>(Y));</span><br><span class="line">    <span class="keyword">while</span> (x)</span><br><span class="line">        X[x_cnt++] = x &amp; <span class="number">1</span>, x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">        Y[y_cnt++] = y &amp; <span class="number">1</span>, y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    cnt = <span class="built_in">max</span>(x_cnt, y_cnt);</span><br><span class="line">    <span class="built_in">reverse</span>(X, X + cnt);</span><br><span class="line">    <span class="built_in">reverse</span>(Y, Y + cnt);</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">0</span>, cnt, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> T;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x, y;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,<span class="built_in">f</span>(x,y));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="通行模板">通行模板</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">33</span>;</span><br><span class="line"><span class="comment">// pos , limit</span></span><br><span class="line"><span class="type">int</span> cnt;</span><br><span class="line"><span class="type">int</span> dp[maxn][<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> A[maxn];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> pos,<span class="type">int</span> limit)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(pos==cnt)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// need to change</span></span><br><span class="line">    <span class="type">int</span> &amp;ans=dp[pos][limit];</span><br><span class="line">    <span class="keyword">if</span>(ans!=<span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=(limit?A[pos]:<span class="number">9</span>);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// do sometihng;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(dp,<span class="number">-1</span>,<span class="built_in">sizeof</span>(dp));</span><br><span class="line">    <span class="keyword">while</span>(x)&#123;</span><br><span class="line">        A[cnt++]=x%<span class="number">10</span>;</span><br><span class="line">        x/=<span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">reverse</span>(A,A+cnt);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">dfs</span>(<span class="number">0</span>,<span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第十二届蓝桥杯国赛居然考了一道数位DP裸题，血赚^_^</p>
<h3 id="参考">参考</h3>
<p>^ 部分内容参考了 <a
target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/348851463">算法学习笔记(68): -
Pecco</a></p>
<p>^ Sum of Log 优化后的代码参考 <a
target="_blank" rel="noopener" href="https://ac.nowcoder.com/acm/discuss/blogs?tagId=139936">[题解]牛客竞赛OJ</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/04/29/ICPC/%E5%9B%BE%E8%AE%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/a1.jpg">
      <meta itemprop="name" content="Htto">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Htto的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/29/ICPC/%E5%9B%BE%E8%AE%BA/" class="post-title-link" itemprop="url">基本图论</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-29 12:34:08" itemprop="dateCreated datePublished" datetime="2021-04-29T12:34:08+08:00">2021-04-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-15 13:55:05" itemprop="dateModified" datetime="2024-06-15T13:55:05+08:00">2024-06-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/%E5%9B%BE%E8%AE%BA/" itemprop="url" rel="index"><span itemprop="name">图论</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>[TOC]</p>
<h2 id="建图">建图</h2>
<h3 id="邻接矩阵">邻接矩阵</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">105</span>;</span><br><span class="line"><span class="type">int</span> G[maxn][maxn];</span><br><span class="line"><span class="type">int</span> vis[maxn];</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    G[u][v] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout &lt;&lt; u &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; vec;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (G[u][i] &amp;&amp; !vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            vec.<span class="built_in">push_back</span>(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(vec.<span class="built_in">begin</span>(), vec.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; vec.<span class="built_in">size</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        vis[vec[i]] = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(vec[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(u);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> cur = q.<span class="built_in">front</span>();</span><br><span class="line">        cout&lt;&lt;cur&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; vec;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (G[cur][i] &amp;&amp; !vis[i])</span><br><span class="line">            &#123;</span><br><span class="line">                vec.<span class="built_in">push_back</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sort</span>(vec.<span class="built_in">begin</span>(), vec.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; vec.<span class="built_in">size</span>(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[vec[i]] = <span class="number">1</span>;</span><br><span class="line">            q.<span class="built_in">push</span>(vec[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">        <span class="built_in">add_edge</span>(u, v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">    cout&lt;&lt;endl;</span><br><span class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="built_in">sizeof</span>(vis));</span><br><span class="line">    <span class="built_in">bfs</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="邻接链表用vector">邻接链表（用vector）</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> from, to;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[maxn];</span><br><span class="line">vector&lt;Edge&gt; edges;</span><br><span class="line"><span class="type">int</span> vis[maxn];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    edges.<span class="built_in">push_back</span>(&#123;u, v&#125;);</span><br><span class="line">    G[u].<span class="built_in">push_back</span>(edges.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">input</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">        <span class="built_in">add_edge</span>(a, b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vis[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// 我们G[u]存的是所有起点为u的边的编号，遍历拿到每一个编号edge_no</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> edge_no : G[u])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 通过边的编号我们拿到这条边的终点，即u的相邻点</span></span><br><span class="line">        <span class="type">int</span> to = edges[edge_no].to;</span><br><span class="line">        <span class="keyword">if</span> (!vis[to])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">dfs</span>(to);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="拓扑排序">拓扑排序</h2>
<p>我们可以对DAG（有向无环图）进行拓扑排序。</p>
<p>用bfs来获得拓扑排序，首先将所有入度为0的节点加入队列。删除这些入度为0的节点（不需要真正删除，只要将相邻节点入度-1就行了），如果因为该节点删除后相邻节点入度为0，将相邻节点也加入队列。</p>
<p>如果我们拓扑排序后线性化的数组中元素个数小于节点数，说明拓扑排序失败（图中有环）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">topo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">if</span> (!deg[i])</span><br><span class="line">            q.<span class="built_in">push</span>(i);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        cnt++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> v : G[u])</span><br><span class="line">        &#123;</span><br><span class="line">            deg[v]--;</span><br><span class="line">            <span class="keyword">if</span> (!deg[v])</span><br><span class="line">                q.<span class="built_in">push</span>(v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cnt == node_cnt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="排序"><a
target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1347">排序</a></h3>
<h4 id="题目大意">题目大意</h4>
<p>一个不同的值的升序排序数列指的是一个从左到右元素依次增大的序列，例如，一个有序的数列
A,B,C,D 表在这道题中<span
class="math inline">\(A&lt;B&lt;C&lt;D\)</span>，我们将给你一系列形如
<span class="math inline">\(A&lt;B\)</span>
的关系，并要求你判断是否能够根据这些关系确定这个数列的顺序。</p>
<h4 id="解题思路">解题思路</h4>
<p>我们将每个字母当作一个节点，一个小于关系就是一条边。然后建图跑拓扑排序，如果图中存在环就说明无解。有的时候图中的拓扑排序是不唯一的，该题还要询问拓扑排序是否唯一（即方案唯一），我们可以记录bfs最长的深度，如果该深度等于节点数，说明有一条有n个节点的链刚好连接所有节点。</p>
<h4 id="ac代码">AC代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e5</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> from;</span><br><span class="line">    <span class="type">int</span> to;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line">vector&lt;Edge&gt; edges;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[maxn];</span><br><span class="line"><span class="type">int</span> deg[maxn];</span><br><span class="line"><span class="type">int</span> Deg[maxn];</span><br><span class="line"><span class="type">int</span> vis[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    edges.<span class="built_in">push_back</span>(&#123;u, v&#125;);</span><br><span class="line">    Deg[v]++;</span><br><span class="line">    G[u].<span class="built_in">push_back</span>(edges.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">topo_sort</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memcpy</span>(deg,Deg,<span class="built_in">sizeof</span>(Deg));</span><br><span class="line">    queue&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">if</span> (deg[i] == <span class="number">0</span>)</span><br><span class="line">            q.<span class="built_in">push</span>(&#123;i, <span class="number">1</span>&#125;);</span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> cur = q.<span class="built_in">front</span>().first;</span><br><span class="line">        <span class="type">int</span> depth = q.<span class="built_in">front</span>().second;</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        ans.<span class="built_in">push_back</span>(cur);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> edge_no : G[cur])</span><br><span class="line">        &#123;</span><br><span class="line">            Edge e = edges[edge_no];</span><br><span class="line">            deg[e.to]--;</span><br><span class="line">            <span class="keyword">if</span> (deg[e.to] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                q.<span class="built_in">push</span>(&#123;e.to, depth + <span class="number">1</span>&#125;);</span><br><span class="line">                res = <span class="built_in">max</span>(res, depth + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (ans.<span class="built_in">size</span>() &lt; n)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span> (res &lt; n)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">char</span> <span class="title">getch</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isspace</span>(ch))</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">return</span> ch;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">char</span> u = <span class="built_in">getch</span>();</span><br><span class="line">        <span class="built_in">getchar</span>();</span><br><span class="line">        <span class="type">char</span> v = <span class="built_in">getch</span>();</span><br><span class="line">        <span class="built_in">add_edge</span>(u - <span class="string">&#x27;A&#x27;</span> + <span class="number">1</span>, v - <span class="string">&#x27;A&#x27;</span> + <span class="number">1</span>);</span><br><span class="line">        ans.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="type">int</span> res = <span class="built_in">topo_sort</span>();</span><br><span class="line">        <span class="keyword">if</span> (res == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;Sorted sequence determined after&quot;</span></span><br><span class="line">                 &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot; relations: &quot;</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> a : ans)</span><br><span class="line">            &#123;</span><br><span class="line">                cout &lt;&lt; (<span class="type">char</span>)(a + <span class="string">&#x27;A&#x27;</span> - <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;.&quot;</span>;</span><br><span class="line">            cout &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (res == <span class="number">-1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;Inconsistency found after &quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot; relations.\n&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Sorted sequence cannot be determined.\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="车站分级"><a
target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1983">车站分级</a></h4>
<h4 id="题目大意-1">题目大意</h4>
<p>题面看上去挺复杂的，大概就是给你很多<strong>车站</strong>，以及很多<strong>车次</strong>，每个车站有一个优先级，如果某一车次在优先级为<span
class="math inline">\(a_i\)</span>的车站停靠了，那么起点和终点之间，所有优先级大于等于<span
class="math inline">\(a_i\)</span>的车站，该车次都必须停靠。一开始这些车站的优先级都不确定，你只知道每个车次会在哪里停靠，请尝试为这些车站分级，输出所需要的最小的级数。</p>
<p><img src="https://cdn.luogu.com.cn/upload/pic/1238.png" /></p>
<h4 id="题目分析">题目分析</h4>
<p>这里有一个显然的顺序就是一辆车次起点站和终点站之间的所有站，停靠的优先级一定大于不停靠的优先级。</p>
<p>我们根据这个建图，然后进行拓扑排序，最后记录一下图中最长深度就行了。其实这一题并没有让你输出拓扑排序，而且保证了有解（也就是无环）你也可以求DAG上最长路直接求出最长深度。</p>
<h4 id="ac代码-1">AC代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> from, to;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[maxn];</span><br><span class="line">vector&lt;Edge&gt; edges;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> vis[maxn];</span><br><span class="line"><span class="type">int</span> G2[maxn][maxn];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; Trans[maxn];</span><br><span class="line"><span class="type">int</span> deg[maxn];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (G2[u][v])</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    G2[u][v] = <span class="number">1</span>;</span><br><span class="line">    deg[v]++;</span><br><span class="line">    edges.<span class="built_in">push_back</span>(&#123;u, v&#125;);</span><br><span class="line">    G[u].<span class="built_in">push_back</span>(edges.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">topo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line">    <span class="comment">// 记录层数</span></span><br><span class="line">    queue&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">if</span> (!deg[i])</span><br><span class="line">            q.<span class="built_in">push</span>(&#123;i, <span class="number">1</span>&#125;);</span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> cur = q.<span class="built_in">front</span>().first;</span><br><span class="line">        <span class="type">int</span> dep = q.<span class="built_in">front</span>().second;</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> e_no : G[cur])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> v = edges[e_no].to;</span><br><span class="line">            deg[v]--;</span><br><span class="line">            <span class="keyword">if</span> (!deg[v])</span><br><span class="line">            &#123;</span><br><span class="line">                q.<span class="built_in">push</span>(&#123;v, dep + <span class="number">1</span>&#125;);</span><br><span class="line">                res = <span class="built_in">max</span>(res, dep + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">input</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> cnt;</span><br><span class="line">        cin &gt;&gt; cnt;</span><br><span class="line">        <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= cnt; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> cur;</span><br><span class="line">            cin &gt;&gt; cur;</span><br><span class="line">            Trans[i].<span class="built_in">push_back</span>(cur);</span><br><span class="line">            vis[cur] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = Trans[i].<span class="built_in">front</span>(); j &lt;= Trans[i].<span class="built_in">back</span>(); j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (vis[j])</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="comment">// 没有走到的车站，优先级肯定比走到的车站优先级低，我们依次连接已经走到的车站。</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> v : Trans[i])</span><br><span class="line">                <span class="built_in">add_edge</span>(j, v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">input</span>();</span><br><span class="line">    cout &lt;&lt; <span class="built_in">topo</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="最小生成树">最小生成树</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">namespace</span> Kruskal</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> from, to, w;</span><br><span class="line">        <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> Edge &amp;e) <span class="type">const</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> w &lt; e.w;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    vector&lt;Edge&gt; edges;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> par[maxn];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        edges.<span class="built_in">push_back</span>(&#123;u, v, d&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            par[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x == par[x] ? x : par[x] = <span class="built_in">find</span>(par[x]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">kruskal</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">sort</span>(edges.<span class="built_in">begin</span>(), edges.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> e : edges)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> a = <span class="built_in">find</span>(e.from), b = <span class="built_in">find</span>(e.to);</span><br><span class="line">            <span class="keyword">if</span> (a == b)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            par[a] = b;</span><br><span class="line">            res += e.w;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; Kruskal::n &gt;&gt; Kruskal::m;</span><br><span class="line">    Kruskal::<span class="built_in">init</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= Kruskal::m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b, c;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;</span><br><span class="line">        Kruskal::<span class="built_in">add_edge</span>(a, b, c);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; Kruskal::<span class="built_in">kruskal</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="cf1408e">CF1408E</h3>
<h4 id="题目大意-2">题目大意</h4>
<p>给你<span class="math inline">\(m\)</span>个集合，<span
class="math inline">\(A_1\)</span>到<span
class="math inline">\(A_m\)</span>，他们元素的范围都为<span
class="math inline">\([1,n]\)</span>的整数，以及数组<span
class="math inline">\(\{a_i\},\{b_i\}\)</span>，在第<span
class="math inline">\(i\)</span>集合删掉元素<span
class="math inline">\(j\)</span>第代价是<span
class="math inline">\(a_i+b_j\)</span>，你可以删除任意一个集合元素。</p>
<p>现在有一个<span
class="math inline">\(n\)</span>个节点的无向图，如果删除操作结束以后元素<span
class="math inline">\(x,y\)</span>在同一个集合<span
class="math inline">\(i\)</span>同时存在，则<span
class="math inline">\(x,y\)</span>之间连一条颜色为<span
class="math inline">\(i\)</span>的边。</p>
<p>问最小代价，使得删除完元素后形成的图不存在一个每条边颜色都不同的环(环长可以为2)</p>
<h4 id="输入">输入</h4>
<p>第一行<span class="math inline">\(m,n\)</span></p>
<p>第二行<span class="math inline">\(m\)</span>个数<span
class="math inline">\(\{a_i\}\)</span></p>
<p>第三行<span class="math inline">\(n\)</span>个数<span
class="math inline">\(\{b_i\}\)</span></p>
<p>下面<span class="math inline">\(m\)</span>行，第一个数字表示<span
class="math inline">\(A_i\)</span>元素的个数，接下来个是<span
class="math inline">\(A_i\)</span>序列</p>
<h4 id="样例">样例</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">CASE <span class="number">1</span></span><br><span class="line"><span class="number">3</span> <span class="number">2</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line"><span class="number">4</span> <span class="number">5</span></span><br><span class="line"><span class="number">2</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line"><span class="number">2</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line"><span class="number">2</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line">ANS:</span><br><span class="line"><span class="number">11</span></span><br><span class="line">  </span><br><span class="line">CASE <span class="number">2</span>:</span><br><span class="line"><span class="number">7</span> <span class="number">8</span></span><br><span class="line"><span class="number">3</span> <span class="number">6</span> <span class="number">7</span> <span class="number">9</span> <span class="number">10</span> <span class="number">7</span> <span class="number">239</span></span><br><span class="line"><span class="number">8</span> <span class="number">1</span> <span class="number">9</span> <span class="number">7</span> <span class="number">10</span> <span class="number">2</span> <span class="number">6</span> <span class="number">239</span></span><br><span class="line"><span class="number">3</span> <span class="number">2</span> <span class="number">1</span> <span class="number">3</span></span><br><span class="line"><span class="number">2</span> <span class="number">4</span> <span class="number">1</span></span><br><span class="line"><span class="number">3</span> <span class="number">1</span> <span class="number">3</span> <span class="number">7</span></span><br><span class="line"><span class="number">2</span> <span class="number">4</span> <span class="number">3</span></span><br><span class="line"><span class="number">5</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span></span><br><span class="line"><span class="number">2</span> <span class="number">5</span> <span class="number">7</span></span><br><span class="line"><span class="number">1</span> <span class="number">8</span></span><br><span class="line">ANS:</span><br><span class="line"><span class="number">66</span></span><br></pre></td></tr></table></figure>
<h4 id="题解">题解</h4>
<p>分别连接每个<span class="math inline">\(j\)</span>到<span
class="math inline">\(A_i\)</span> 边权为<span
class="math inline">\(a[i]+b[j]\)</span>，然后跑最大生成树。最后拿所有边权和减去这个最大生成树，这个最大生成树就是不存在环的最优解。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> a[maxn];</span><br><span class="line"><span class="type">int</span> b[maxn];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; A[maxn];</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Kruskal</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> from, to, w;</span><br><span class="line">        <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> Edge &amp;e) <span class="type">const</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> w &gt; e.w;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    vector&lt;Edge&gt; edges;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> par[maxn];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        edges.<span class="built_in">push_back</span>(&#123;u, v, d&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            par[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x == par[x] ? x : par[x] = <span class="built_in">find</span>(par[x]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">kruskal</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">sort</span>(edges.<span class="built_in">begin</span>(), edges.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> e : edges)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> a = <span class="built_in">find</span>(e.from), b = <span class="built_in">find</span>(e.to);</span><br><span class="line">            <span class="keyword">if</span> (a == b)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            par[a] = b;</span><br><span class="line">            res += e.w;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">input</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; m &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">        cin &gt;&gt; a[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        cin &gt;&gt; b[i];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> cnt;</span><br><span class="line">        cin &gt;&gt; cnt;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= cnt; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> tmp;</span><br><span class="line">            cin &gt;&gt; tmp;</span><br><span class="line">            A[i].<span class="built_in">push_back</span>(tmp);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">input</span>();</span><br><span class="line">    Kruskal::n = n + m + <span class="number">1</span>;</span><br><span class="line">    Kruskal::<span class="built_in">init</span>();</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> j : A[i])</span><br><span class="line">        &#123;</span><br><span class="line">            ans += a[i] + b[j];</span><br><span class="line">            Kruskal::<span class="built_in">add_edge</span>(j, i + n, a[i] + b[j]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; ans - Kruskal::<span class="built_in">kruskal</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="最短路">最短路</h2>
<h3 id="spfa">SPFA</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span>&#123;</span><br><span class="line">    <span class="type">int</span> from,to;</span><br><span class="line">    <span class="type">int</span> dist;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">1e4</span>+<span class="number">5</span>;</span><br><span class="line">vector&lt;Edge&gt; edges;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[maxn];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v,<span class="type">int</span> dist)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    edges.<span class="built_in">push_back</span>(&#123;u,v,dist&#125;);</span><br><span class="line">    G[u].<span class="built_in">push_back</span>(edges.<span class="built_in">size</span>()<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n,m,s;</span><br><span class="line"><span class="type">int</span> vis[maxn];</span><br><span class="line"><span class="type">int</span> dist[maxn];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">input</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m&gt;&gt;s;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u,v,d;</span><br><span class="line">        cin&gt;&gt;u&gt;&gt;v&gt;&gt;d;</span><br><span class="line">        <span class="built_in">add_edge</span>(u,v,d);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dist,<span class="number">0x3f</span>,<span class="built_in">sizeof</span>(dist));</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(s);</span><br><span class="line">    vis[s]=<span class="number">1</span>;</span><br><span class="line">    dist[s]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(q.<span class="built_in">size</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u=q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        vis[u]=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">size_t</span> i=<span class="number">0</span>;i&lt;G[u].<span class="built_in">size</span>();i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Edge e=edges[G[u][i]];</span><br><span class="line">            <span class="type">int</span> v= e.to,d=e.dist;</span><br><span class="line">            <span class="keyword">if</span>(dist[v] &gt; dist[u]+d)</span><br><span class="line">            &#123;</span><br><span class="line">                dist[v]=dist[u]+d;</span><br><span class="line">                <span class="keyword">if</span>(!vis[v])</span><br><span class="line">                &#123;</span><br><span class="line">                    vis[v]=<span class="number">1</span>;</span><br><span class="line">                    q.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">input</span>();</span><br><span class="line">    <span class="built_in">spfa</span>(s);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        cout&lt;&lt;dist[i]&lt;&lt;<span class="string">&quot; \n&quot;</span>[i==n];</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="dijkstra">Dijkstra</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;    </span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> from, to, d;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">NodeCmp</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> d;</span><br><span class="line">    <span class="type">int</span> x;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> NodeCmp &amp; nc)<span class="type">const</span> </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> d&gt;nc.d;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> N,M;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">100005</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Dj</span></span><br><span class="line">&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; G[maxn];</span><br><span class="line">    vector&lt;Edge&gt; edges;</span><br><span class="line">    <span class="type">int</span> vis[maxn];</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> d[maxn];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        edges.<span class="built_in">push_back</span>(Edge&#123;x, y, v&#125;);</span><br><span class="line">        G[x].<span class="built_in">push_back</span>(edges.<span class="built_in">size</span>()<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> s)</span></span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(d,<span class="number">0x3f</span>,<span class="built_in">sizeof</span>(d));</span><br><span class="line">        <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="built_in">sizeof</span>(vis));</span><br><span class="line">        d[s]=<span class="number">0</span>;</span><br><span class="line">        priority_queue&lt;NodeCmp&gt; q;</span><br><span class="line">        q.<span class="built_in">push</span>(&#123;<span class="number">0LL</span>,s&#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> cur_d=q.<span class="built_in">top</span>().d;</span><br><span class="line">            <span class="type">int</span> u=q.<span class="built_in">top</span>().x;</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span>(vis[u])</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            vis[u]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;G[u].<span class="built_in">size</span>();i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> v=edges[G[u][i]].to;</span><br><span class="line">                <span class="keyword">if</span>(d[v]&gt;d[u]+edges[G[u][i]].d)</span><br><span class="line">                &#123;</span><br><span class="line">                    d[v]=d[u]+edges[G[u][i]].d;</span><br><span class="line">                    q.<span class="built_in">push</span>(&#123;d[v],v&#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;dj;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> s;</span><br><span class="line">    cin&gt;&gt;N&gt;&gt;M&gt;&gt;s;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;M;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a,b,c;</span><br><span class="line">        cin&gt;&gt;a&gt;&gt;b&gt;&gt;c;</span><br><span class="line">        dj.<span class="built_in">add_edge</span>(a,b,c);</span><br><span class="line">        <span class="comment">//rev_dj.add_edge(b,a,c);</span></span><br><span class="line">    &#125;</span><br><span class="line">    dj.<span class="built_in">solve</span>(s);</span><br><span class="line">    <span class="comment">//rev_dj.solve(0);</span></span><br><span class="line">    <span class="type">int</span> sum=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;i++)</span><br><span class="line">        std::cout&lt;&lt;dj.d[i]&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">    <span class="comment">//std::cout&lt;&lt;sum;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="缩点">缩点</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">20005</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> from,to;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> value[maxn],N,M;</span><br><span class="line"><span class="type">int</span> ng[maxn],ans[maxn];</span><br><span class="line"><span class="type">int</span> rd[maxn];</span><br><span class="line"><span class="type">int</span> dfn[maxn],low[maxn],vis[maxn],tim=<span class="number">1</span>;</span><br><span class="line">vector&lt;Edge&gt; edges;</span><br><span class="line">vector&lt;Edge&gt; new_edges;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; stac;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; new_G[maxn];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[maxn];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> from,<span class="type">int</span> to)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    edges.<span class="built_in">push_back</span>(&#123;from,to&#125;);</span><br><span class="line">    G[from].<span class="built_in">push_back</span>(edges.<span class="built_in">size</span>()<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    low[u]=dfn[u]=++tim;</span><br><span class="line">    vis[u]=<span class="number">1</span>;</span><br><span class="line">    stac.<span class="built_in">push_back</span>(u);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;G[u].<span class="built_in">size</span>();i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> v=edges[G[u][i]].to;</span><br><span class="line">        <span class="keyword">if</span>(!dfn[v])&#123;</span><br><span class="line">            <span class="built_in">tarjan</span>(v);</span><br><span class="line">            low[u]=<span class="built_in">min</span>(low[u],low[v]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(vis[v]) low[u]=<span class="built_in">min</span>(low[u],dfn[v]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//printf(&quot;TIME TIK:(%d,%d)\n&quot;,dfn[u],low[u]);</span></span><br><span class="line">    <span class="keyword">if</span>(dfn[u]==low[u])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> v;</span><br><span class="line">        <span class="keyword">while</span>(v=stac.<span class="built_in">back</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// printf(&quot;%d &quot;,v);</span></span><br><span class="line">            stac.<span class="built_in">pop_back</span>();</span><br><span class="line">            ng[v]=u;</span><br><span class="line">            vis[v]=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span>(u==v)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            value[u]+=value[v];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rebuild</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;M;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u=ng[edges[i].from],v=ng[edges[i].to];</span><br><span class="line">        <span class="keyword">if</span>(u!=v)</span><br><span class="line">        &#123;</span><br><span class="line">            new_edges.<span class="built_in">push_back</span>(&#123;u,v&#125;);</span><br><span class="line">            <span class="comment">// printf(&quot;LINK %d,%d %d\n&quot;,u,v,rd[v]+1);</span></span><br><span class="line">            new_G[u].<span class="built_in">push_back</span>(new_edges.<span class="built_in">size</span>()<span class="number">-1</span>);</span><br><span class="line">            rd[v]++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">topo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(ng[i]==i&amp;&amp;!rd[i] ) </span><br><span class="line">        &#123;</span><br><span class="line">            q.<span class="built_in">push</span>(i);</span><br><span class="line">            ans[i]=value[i];</span><br><span class="line">            <span class="comment">// printf(&quot;VALUE %d %d\n&quot;,i,value[i]);</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u=q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;new_G[u].<span class="built_in">size</span>();i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Edge e=new_edges[new_G[u][i]];</span><br><span class="line">            <span class="type">int</span> v=e.to;</span><br><span class="line">            ans[v]=<span class="built_in">max</span>(ans[v],ans[u]+value[v]);</span><br><span class="line">            rd[v]--;</span><br><span class="line">            <span class="keyword">if</span>(rd[v]==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// printf(&quot;ADD %d\n&quot;,v);</span></span><br><span class="line">                q.<span class="built_in">push</span>(v);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin&gt;&gt;N&gt;&gt;M;</span><br><span class="line">    <span class="built_in">memset</span>(rd,<span class="number">0</span>,<span class="built_in">sizeof</span>(rd));</span><br><span class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="built_in">sizeof</span>(vis));</span><br><span class="line">    <span class="built_in">memset</span>(ng,<span class="number">0</span>,<span class="built_in">sizeof</span>(ng));</span><br><span class="line">    <span class="built_in">memset</span>(ans,<span class="number">0</span>,<span class="built_in">sizeof</span>(ans));</span><br><span class="line">    <span class="built_in">memset</span>(dfn,<span class="number">0</span>,<span class="built_in">sizeof</span>(dfn));</span><br><span class="line">    <span class="built_in">memset</span>(low,<span class="number">0</span>,<span class="built_in">sizeof</span>(low));</span><br><span class="line">    <span class="built_in">memset</span>(value,<span class="number">0</span>,<span class="built_in">sizeof</span>(value));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;i++)</span><br><span class="line">        cin&gt;&gt;value[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=M;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a,b;</span><br><span class="line">        cin&gt;&gt;a&gt;&gt;b;</span><br><span class="line">        <span class="built_in">add_edge</span>(a,b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// printf(&quot;\n================\n&quot;);</span></span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;i++)</span><br><span class="line">        <span class="keyword">if</span>(!dfn[i]) <span class="built_in">tarjan</span>(i);</span><br><span class="line">    <span class="built_in">rebuild</span>();</span><br><span class="line">    <span class="built_in">topo</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;i++)</span><br><span class="line">        res=<span class="built_in">max</span>(res,ans[i]);</span><br><span class="line">    cout&lt;&lt;res;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="割点">割点</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">2e4</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span>&#123;</span><br><span class="line">    <span class="type">int</span> from,to;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;Edge&gt; edges;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[maxn];</span><br><span class="line"><span class="type">int</span> dfn[maxn],low[maxn],tim=<span class="number">0</span>,cut[maxn];</span><br><span class="line"><span class="type">int</span> N,M;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    edges.<span class="built_in">push_back</span>(&#123;u,v&#125;);</span><br><span class="line">    G[u].<span class="built_in">push_back</span>(edges.<span class="built_in">size</span>()<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dfn[u]=low[u]=++tim;</span><br><span class="line">    <span class="type">int</span> child=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;G[u].<span class="built_in">size</span>();i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> v=edges[G[u][i]].to;</span><br><span class="line">        <span class="keyword">if</span>(!dfn[v])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">tarjan</span>(v,fa);</span><br><span class="line">            low[u]=<span class="built_in">min</span>(low[v],low[u]);</span><br><span class="line">            <span class="keyword">if</span>(low[v] &gt;= dfn[u] &amp;&amp; u!=fa)</span><br><span class="line">                cut[u]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(u==fa)</span><br><span class="line">                child++;</span><br><span class="line">        &#125;</span><br><span class="line">        low[u]=<span class="built_in">min</span>(low[u],dfn[v]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(child&gt;=<span class="number">2</span>)</span><br><span class="line">        cut[u]=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin&gt;&gt;N&gt;&gt;M;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;M;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a,b;</span><br><span class="line">        cin&gt;&gt;a&gt;&gt;b;</span><br><span class="line">        <span class="built_in">add_edge</span>(a,b);</span><br><span class="line">        <span class="built_in">add_edge</span>(b,a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;i++)</span><br><span class="line">        <span class="keyword">if</span>(!dfn[i])</span><br><span class="line">            <span class="built_in">tarjan</span>(i,i);</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; res;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;i++)</span><br><span class="line">        <span class="keyword">if</span>(cut[i])</span><br><span class="line">            res.<span class="built_in">push_back</span>(i);</span><br><span class="line">    cout&lt;&lt;res.<span class="built_in">size</span>()&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;res.<span class="built_in">size</span>();i++)</span><br><span class="line">        cout&lt;&lt;res[i]&lt;&lt;<span class="string">&quot; \n&quot;</span>[i==res.<span class="built_in">size</span>()<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="差分约束">差分约束</h2>
<p>差分约束系统是下面形式的多元一次不等式组（<span
class="math inline">\(y_1,y_2...y_n\)</span>是已知量）</p>
<p><span class="math display">\[
\begin{align}
&amp; x_{c1}-x_{c1&#39;}\le y_1 \\
&amp; x_{c2}-x_{c2&#39;}\le y_2 \\
&amp; ... \\
&amp; x_{c_n}-x_{c_n&#39;}\le y_n \\
\end{align}
\]</span></p>
<p>我们转换为<span class="math inline">\(x_{c_i} \le x_{c_i&#39;} +
y_i\)</span> 我们将<span class="math inline">\(c_i&#39;\)</span>到<span
class="math inline">\(c_i\)</span>连上一条权值为<span
class="math inline">\(y_i\)</span>的边，然后引入一个超级源点，将其他所有点连一条权值为0点边。</p>
<p><span
class="math inline">\({x_i}\)</span>的一组解就是从超级源点出发的最短路。如果没有最短路，就无解。我们得到的一组解可以同时加上或减去一个数（设置dist[0]的值），也是一组解。</p>
<p>这里其实求的是满足 <span class="math inline">\(x_i\le
dist[0]\)</span>的最大解，如果我们要求<span class="math inline">\(x_i\ge
dist[0]\)</span>最小解我们就可以修改程序的的<strong>三角形不等式的比较符号</strong>以及<strong>差分约束的比较符号</strong>变为<span
class="math inline">\(\ge\)</span><strong>并将dist初始化为-INF</strong>
即可。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> from, to;</span><br><span class="line">    <span class="type">int</span> d;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[maxn];</span><br><span class="line">vector&lt;Edge&gt; edges;</span><br><span class="line"><span class="type">int</span> cnt[maxn];</span><br><span class="line"><span class="type">int</span> dist[maxn];</span><br><span class="line"><span class="type">int</span> vis[maxn];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    edges.<span class="built_in">push_back</span>(&#123;u, v, d&#125;);</span><br><span class="line">    G[u].<span class="built_in">push_back</span>(edges.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">input</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b, c;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;</span><br><span class="line">        <span class="built_in">add_edge</span>(b,a, c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">add_edge</span>(n + <span class="number">1</span>, i, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    <span class="built_in">memset</span>(dist, <span class="number">0x3f</span>, <span class="built_in">sizeof</span>(dist));</span><br><span class="line">    q.<span class="built_in">push</span>(n + <span class="number">1</span>);</span><br><span class="line">    vis[n + <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    dist[n+<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> cur = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        vis[cur] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> eno : G[cur])</span><br><span class="line">        &#123;</span><br><span class="line">            Edge e = edges[eno];</span><br><span class="line">            <span class="keyword">if</span> (dist[e.to] &gt; dist[cur] + e.d)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (++cnt[e.to] &gt; <span class="number">2</span> * n)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                dist[e.to] = dist[cur] + e.d;</span><br><span class="line">                <span class="keyword">if</span> (!vis[e.to])</span><br><span class="line">                &#123;</span><br><span class="line">                    q.<span class="built_in">push</span>(e.to);</span><br><span class="line">                    vis[e.to] = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">input</span>();</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">spfa</span>())</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;NO&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">            cout&lt;&lt;dist[i]&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实际问题中可能不仅仅是小于的关系，我们可以进行转化</p>
<ol type="1">
<li><p><span class="math inline">\(x_1 - x_2 \ge y\)</span> 转化为 <span
class="math inline">\(x_2-x_1 \le -y\)</span></p></li>
<li><p><span class="math inline">\(x_1-x_2 = y\)</span> 转化为 <span
class="math inline">\(x_1-x_2 \le y\)</span> 且 <span
class="math inline">\(x_2 - x_1 \le y\)</span></p></li>
<li><p><span class="math inline">\(x_1 - x_2 \lt y\)</span> 转化为 <span
class="math inline">\(x_1 - x_2 \le y - 1\)</span></p></li>
<li><p>$x_1 - x_2 &gt; y $转化为 <span class="math inline">\(x_2 - x_1
\le -y -1\)</span></p></li>
</ol>
<h3 id="p1250-种树">P1250 种树</h3>
<blockquote>
<p><strong>题目描述</strong>
一条街的一边有几座房子。因为环保原因居民想要在路边种些树。路边的地区被分割成块，并被编号成1..N。每个部分为一个单位尺寸大小并最多可种一棵树。每个居民想在门前种些树并指定了三个号码B，E，T。这三个数表示该居民想在B和E之间最少种T棵树。当然，B≤E，居民必须记住在指定区不能种多于区域地块数的树，所以T≤E-B+l。居民们想种树的各自区域可以交叉。你的任务是求出能满足所有要求的最少的树的数量。
写一个程序完成以下工作： <strong>输入格式</strong>
第一行包含数据N，区域的个数(0&lt;N≤30000)；
第二行包含H，房子的数目(0&lt;H≤5000)； 下面的H行描述居民们的需要：B E
T，0&lt;B≤E≤30000，T≤E-B+1。 <strong>输出格式</strong>
输出文件只有一行写有树的数目</p>
</blockquote>
<p>我们可以用前缀和来处理，就是要满足</p>
<p>$ S_E-S_{B-1}T$且<span class="math inline">\(0 \le S_i-S_{i-1} \le
1\)</span></p>
<p>然后跑一个差分约束即可。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> from, to, dist;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[maxn];</span><br><span class="line">vector&lt;Edge&gt; edges;</span><br><span class="line"><span class="type">int</span> dist[maxn];</span><br><span class="line"><span class="type">int</span> vis[maxn];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    edges.<span class="built_in">push_back</span>(&#123;u, v, c&#125;);</span><br><span class="line">    G[u].<span class="built_in">push_back</span>(edges.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">spfa</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dist, <span class="number">-0x3f</span>, <span class="built_in">sizeof</span>(dist));</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(<span class="number">0</span>);</span><br><span class="line">    vis[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    dist[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> cur = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        vis[cur] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> edge_no : G[cur])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">auto</span> e = edges[edge_no];</span><br><span class="line">            <span class="keyword">if</span> (dist[e.to] &lt; dist[cur] + e.dist)</span><br><span class="line">            &#123;</span><br><span class="line">                dist[e.to] = dist[cur] + e.dist;</span><br><span class="line">                <span class="keyword">if</span> (!vis[e.to])</span><br><span class="line">                &#123;</span><br><span class="line">                    q.<span class="built_in">push</span>(e.to);</span><br><span class="line">                    vis[e.to] = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">input</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b, c;</span><br><span class="line">        cin &gt;&gt; b &gt;&gt; a &gt;&gt; c;</span><br><span class="line">        <span class="built_in">add_edge</span>(b - <span class="number">1</span>, a, c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">add_edge</span>(i - <span class="number">1</span>, i, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">add_edge</span>(i, i - <span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">input</span>();</span><br><span class="line">    <span class="built_in">spfa</span>();</span><br><span class="line">    cout &lt;&lt; dist[n];</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="网络流">网络流</h2>
<h3 id="模板">模板</h3>
<h4 id="ford-fulkson">Ford-Fulkson</h4>
<p>Ford-Fulkson算法，对于一个有向图，要求图中的最大流我们可以建图的时候连上反向边并初始化为0，不断求增广路。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m, start, dest;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> from, to;</span><br><span class="line">    <span class="type">int</span> d;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[maxn];</span><br><span class="line">vector&lt;Edge&gt; edges;</span><br><span class="line"><span class="type">int</span> vis[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    edges.<span class="built_in">push_back</span>(&#123;u, v, d&#125;);</span><br><span class="line">    G[u].<span class="built_in">push_back</span>(edges.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">input</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; start &gt;&gt; dest;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b, c;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;</span><br><span class="line">        <span class="built_in">add_edge</span>(a, b, c);</span><br><span class="line">        <span class="built_in">add_edge</span>(b, a, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> flow)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (u == t)</span><br><span class="line">        <span class="keyword">return</span> flow;</span><br><span class="line">    vis[u] = <span class="literal">true</span>;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> e_no : G[u])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> &amp;e = edges[e_no];</span><br><span class="line">        <span class="keyword">if</span> (vis[e.to] || e.d &lt;= <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> ((res = <span class="built_in">dfs</span>(e.to, t, <span class="built_in">min</span>(flow, e.d))) &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            edges[e_no].d -= res;</span><br><span class="line">            edges[e_no ^ <span class="number">1</span>].d += res;</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">max_flow</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="built_in">sizeof</span>(vis));</span><br><span class="line">        <span class="type">int</span> tmp = <span class="built_in">dfs</span>(s, t, <span class="number">0x3f3f3f3f</span>);</span><br><span class="line">        <span class="keyword">if</span> (tmp)</span><br><span class="line">            res += tmp;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">input</span>();</span><br><span class="line">    cout &lt;&lt; <span class="built_in">max_flow</span>(start, dest);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ek">EK</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m, start, dest;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> from, to;</span><br><span class="line">    <span class="type">int</span> flow;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[maxn];</span><br><span class="line">vector&lt;Edge&gt; edges;</span><br><span class="line"><span class="type">int</span> vis[maxn];</span><br><span class="line"><span class="type">int</span> A[maxn];</span><br><span class="line"><span class="type">int</span> last[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    edges.<span class="built_in">push_back</span>(&#123;u, v, d&#125;);</span><br><span class="line">    G[u].<span class="built_in">push_back</span>(edges.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">input</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; start &gt;&gt; dest;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b, c;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;</span><br><span class="line">        <span class="built_in">add_edge</span>(a, b, c);</span><br><span class="line">        <span class="built_in">add_edge</span>(b, a, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">max_flow</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">        q.<span class="built_in">push</span>(s);</span><br><span class="line">        <span class="built_in">memset</span>(A, <span class="number">0</span>, <span class="built_in">sizeof</span>(A));</span><br><span class="line">        <span class="built_in">memset</span>(last, <span class="number">-1</span>, <span class="built_in">sizeof</span>(last));</span><br><span class="line">        A[s] = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> cur = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> e_no : G[cur])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">auto</span> e = edges[e_no];</span><br><span class="line">                <span class="keyword">if</span> (last[e.to] == <span class="number">-1</span> &amp;&amp; e.flow)</span><br><span class="line">                &#123;</span><br><span class="line">                    last[e.to] = e_no;</span><br><span class="line">                    A[e.to] = <span class="built_in">min</span>(e.flow, A[e.from]);</span><br><span class="line">                    q.<span class="built_in">push</span>(e.to);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 到汇点无流量，即可退出</span></span><br><span class="line">        <span class="keyword">if</span> (!A[t])</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        res += A[t];</span><br><span class="line">        <span class="comment">// 找到的路径榨流量</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> cur = t; cur != s; cur = edges[last[cur]].from)</span><br><span class="line">        &#123;</span><br><span class="line">            edges[last[cur]].flow -= A[t];</span><br><span class="line">            edges[last[cur] ^ <span class="number">1</span>].flow += A[t];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">input</span>();</span><br><span class="line">    cout &lt;&lt; <span class="built_in">max_flow</span>(start, dest);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="dinic-模版">Dinic 模版</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">namespace</span> Dinic</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> s, t;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> maxn = <span class="number">20005</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> maxm = <span class="number">1000100</span>;</span><br><span class="line">    <span class="type">int</span> head[maxn], cur[maxn], depth[maxn];</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">1</span>, n = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> to, next, cap;</span><br><span class="line">    &#125;;</span><br><span class="line">    Edge edges[maxm];</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span> _add_edge(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> c)</span><br><span class="line">    &#123;</span><br><span class="line">        edges[++cnt].to = v;</span><br><span class="line">        edges[cnt].cap = c;</span><br><span class="line">        edges[cnt].next = head[u];</span><br><span class="line">        head[u] = cnt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// printf(&quot;&#123;%d,%d,%d&#125;\n&quot;,u,v,c);</span></span><br><span class="line">        _add_edge(u, v, c);</span><br><span class="line">        _add_edge(v, u, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(depth, <span class="number">-1</span>, <span class="built_in">sizeof</span>(depth));</span><br><span class="line">        depth[s] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; i++)</span><br><span class="line">            cur[i] = head[i];</span><br><span class="line">        cur[t]= head[t];</span><br><span class="line">        cur[s]= head[s];</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">        q.<span class="built_in">push</span>(s);</span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = edges[i].next)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> to = edges[i].to;</span><br><span class="line">                <span class="keyword">if</span> (depth[to] == <span class="number">-1</span> &amp;&amp; edges[i].cap &gt; <span class="number">0</span>)</span><br><span class="line">                    depth[to] = depth[u] + <span class="number">1</span>, q.<span class="built_in">push</span>(to);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> depth[t] != <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> from, <span class="type">int</span> flow)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (from == t)</span><br><span class="line">            <span class="keyword">return</span> flow;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> res = flow;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = cur[from]; i &amp;&amp; res; i = edges[i].next)</span><br><span class="line">        &#123;</span><br><span class="line">            cur[from] = i;</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> to = edges[i].to;</span><br><span class="line">            <span class="type">int</span> cap = edges[i].cap;</span><br><span class="line">            <span class="keyword">if</span> (cap &gt; <span class="number">0</span> &amp;&amp; depth[to] == depth[from] + <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> c = <span class="built_in">dfs</span>(to, <span class="built_in">min</span>(cap, res));</span><br><span class="line">                res -= c;</span><br><span class="line">                edges[i].cap -= c;</span><br><span class="line">                edges[i ^ <span class="number">1</span>].cap += c;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flow - res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">dinic</span><span class="params">(<span class="type">int</span> _s,<span class="type">int</span> <span class="type">_t</span>,<span class="type">int</span> _n)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        s=_s;</span><br><span class="line">        t=<span class="type">_t</span>;</span><br><span class="line">        n=_n;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">bfs</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            ret += <span class="built_in">dfs</span>(s, <span class="number">0x3f3f3f3f</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">// namespace Dinic</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n,m,s,t;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m&gt;&gt;s&gt;&gt;t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a,b,c;</span><br><span class="line">        cin&gt;&gt;a&gt;&gt;b&gt;&gt;c;</span><br><span class="line">        Dinic::<span class="built_in">add</span>(a,b,c);</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;Dinic::<span class="built_in">dinic</span>(s,t,n);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="mcmf模版">MCMF模版</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">namespace</span> MCMF</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> maxn=<span class="number">100005</span>;</span><br><span class="line">    <span class="type">int</span> s, t;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> from, to, w, c;</span><br><span class="line">    &#125;;</span><br><span class="line">    vector&lt;Edge&gt; edges;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; G[maxn];</span><br><span class="line">    <span class="type">int</span> dist[maxn];</span><br><span class="line">    <span class="type">int</span> pre[maxn];</span><br><span class="line">    <span class="type">int</span> vis[maxn];</span><br><span class="line">    <span class="type">int</span> flow[maxn];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w, <span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        edges.<span class="built_in">push_back</span>(&#123;u, v, w, c&#125;);</span><br><span class="line">        G[u].<span class="built_in">push_back</span>(edges.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v,<span class="type">int</span> w,<span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">add_edge</span>(u,v,w,c);</span><br><span class="line">        <span class="built_in">add_edge</span>(v,u,<span class="number">0</span>,-c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// init</span></span><br><span class="line">        <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line">        <span class="built_in">memset</span>(flow, <span class="number">-1</span>, <span class="built_in">sizeof</span>(flow));</span><br><span class="line">        <span class="built_in">memset</span>(dist, <span class="number">0x3f</span>, <span class="built_in">sizeof</span>(dist));</span><br><span class="line">        <span class="built_in">memset</span>(pre, <span class="number">-1</span>, <span class="built_in">sizeof</span>(pre));</span><br><span class="line">        dist[s] = <span class="number">0</span>;</span><br><span class="line">        flow[s] = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">        <span class="comment">// spfa</span></span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">        q.<span class="built_in">push</span>(s);</span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            vis[u] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> idx : G[u])</span><br><span class="line">            &#123;</span><br><span class="line">                Edge e = edges[idx];</span><br><span class="line">                <span class="type">int</span> v = e.to;</span><br><span class="line">                <span class="keyword">if</span> (e.w &amp;&amp; dist[v] &gt; dist[u] + e.c)</span><br><span class="line">                &#123;</span><br><span class="line">                    dist[v] = dist[u] + e.c;</span><br><span class="line">                    flow[v] = <span class="built_in">min</span>(flow[u], e.w);</span><br><span class="line">                    pre[v] = idx;</span><br><span class="line">                    <span class="keyword">if</span> (!vis[v])</span><br><span class="line">                    &#123;</span><br><span class="line">                        q.<span class="built_in">push</span>(v);</span><br><span class="line">                        vis[v] = <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flow[t] != <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// first max_flow, second min_cost</span></span><br><span class="line">    <span class="function">std::pair&lt;<span class="type">long</span> <span class="type">long</span>,<span class="type">long</span> <span class="type">long</span>&gt; <span class="title">MCMF</span><span class="params">(<span class="type">int</span> _s,<span class="type">int</span> <span class="type">_t</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        s=_s,t=<span class="type">_t</span>;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> max_flow = <span class="number">0</span>, min_cost = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">spfa</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            max_flow += flow[t];</span><br><span class="line">            min_cost += dist[t] * flow[t];</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = t; pre[i] != <span class="number">-1</span>; i = edges[pre[i]].from)</span><br><span class="line">            &#123;</span><br><span class="line">                edges[pre[i]].w -= flow[t];</span><br><span class="line">                edges[pre[i] ^ <span class="number">1</span>].w += flow[t];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;max_flow,min_cost&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">// namespace MCMF</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="p1251-餐饮计划问题">P1251 餐饮计划问题</h3>
<h4 id="题目大意-3">题目大意</h4>
<p>一个餐厅<span class="math inline">\(n\)</span>天，每天需要<span
class="math inline">\(r_i\)</span>个餐巾，每天可以花<span
class="math inline">\(p\)</span>分购买新餐巾，也可以送到快洗店，洗一块需要<span
class="math inline">\(m\)</span>天其费用是<span
class="math inline">\(f\)</span>分，或者送到慢洗部，洗一块需要<span
class="math inline">\(n\)</span>天其费用为<span
class="math inline">\(s\)</span>，每天结束会产生脏餐巾。问满足每天需求量最小的花费。</p>
<p><strong>输入</strong></p>
<p>第一行<span class="math inline">\(N\)</span></p>
<p>第二行<span class="math inline">\(p,m,f,n,s\)</span></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">输入:</span><br><span class="line">3</span><br><span class="line">1 7 5 </span><br><span class="line">11 2 2 3 1</span><br><span class="line">输出:</span><br><span class="line">134</span><br></pre></td></tr></table></figure>
<h4 id="分析">分析</h4>
<p>可以考虑拆点，将一天拆成白天和黑夜白天用的餐巾到了晚上就会变脏衣服。</p>
<ol type="1">
<li>从源点引入费用为<span
class="math inline">\(p\)</span>，容量为inf的边连接<strong>第<span
class="math inline">\(i\)</span>天早上</strong>，代表可以买餐具</li>
<li>从<strong>第<span
class="math inline">\(i\)</span>天早上</strong>引入费用为0，容量为inf的边连接汇点，这样跑最大流的时候会帮自动保证第<span
class="math inline">\(i\)</span>天餐巾是够的。</li>
<li>从源点引入费用为0，容量为<span
class="math inline">\(r_i\)</span>的边连接到<strong>第<span
class="math inline">\(i\)</span>天晚上</strong>，说明早上的衣服脏了留到了晚上。</li>
<li>连接<strong>第<span
class="math inline">\(i\)</span>天晚上</strong>到<strong>第<span
class="math inline">\(i+m\)</span>天早上</strong>，费用为快洗费用，流量为inf,
使用快洗</li>
<li>连接<strong>第<span
class="math inline">\(i\)</span>天晚上</strong>到<strong>第<span
class="math inline">\(i+n\)</span>
天早上</strong>，费用为慢洗费用，流量为inf, 使用慢洗</li>
<li>连接<strong>第<span
class="math inline">\(i\)</span>天早上</strong>到<strong>第<span
class="math inline">\(i+1\)</span>天早上</strong>，费用为0，流量为inf,
干净的衣服留到第二天。(留脏衣服好像也行，都AC了。。。。)</li>
</ol>
<h4 id="ac代码-2">AC代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">20005</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">namespace</span> MCMF</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> s, t;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> from, to, w, c;</span><br><span class="line">    &#125;;</span><br><span class="line">    vector&lt;Edge&gt; edges;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; G[maxn];</span><br><span class="line">    <span class="type">int</span> dist[maxn];</span><br><span class="line">    <span class="type">int</span> pre[maxn];</span><br><span class="line">    <span class="type">int</span> vis[maxn];</span><br><span class="line">    <span class="type">int</span> flow[maxn];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add_edge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w, <span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        edges.<span class="built_in">push_back</span>(&#123;u, v, w, c&#125;);</span><br><span class="line">        G[u].<span class="built_in">push_back</span>(edges.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v,<span class="type">int</span> w,<span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">add_edge</span>(u,v,w,c);</span><br><span class="line">        <span class="built_in">add_edge</span>(v,u,<span class="number">0</span>,-c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// init</span></span><br><span class="line">        <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line">        <span class="built_in">memset</span>(flow, <span class="number">-1</span>, <span class="built_in">sizeof</span>(flow));</span><br><span class="line">        <span class="built_in">memset</span>(dist, <span class="number">0x3f</span>, <span class="built_in">sizeof</span>(dist));</span><br><span class="line">        <span class="built_in">memset</span>(pre, <span class="number">-1</span>, <span class="built_in">sizeof</span>(pre));</span><br><span class="line">        dist[s] = <span class="number">0</span>;</span><br><span class="line">        flow[s] = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">        <span class="comment">// spfa</span></span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">        q.<span class="built_in">push</span>(s);</span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            vis[u] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> idx : G[u])</span><br><span class="line">            &#123;</span><br><span class="line">                Edge e = edges[idx];</span><br><span class="line">                <span class="type">int</span> v = e.to;</span><br><span class="line">                <span class="keyword">if</span> (e.w &amp;&amp; dist[v] &gt; dist[u] + e.c)</span><br><span class="line">                &#123;</span><br><span class="line">                    dist[v] = dist[u] + e.c;</span><br><span class="line">                    flow[v] = <span class="built_in">min</span>(flow[u], e.w);</span><br><span class="line">                    pre[v] = idx;</span><br><span class="line">                    <span class="keyword">if</span> (!vis[v])</span><br><span class="line">                    &#123;</span><br><span class="line">                        q.<span class="built_in">push</span>(v);</span><br><span class="line">                        vis[v] = <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flow[t] != <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// first max_flow, second min_cost</span></span><br><span class="line">    <span class="function">std::pair&lt;<span class="type">long</span> <span class="type">long</span>,<span class="type">long</span> <span class="type">long</span>&gt; <span class="title">MFMC</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> max_flow = <span class="number">0</span>, min_cost = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">spfa</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            max_flow += flow[t];</span><br><span class="line">            min_cost += dist[t] * flow[t];</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = t; pre[i] != <span class="number">-1</span>; i = edges[pre[i]].from)</span><br><span class="line">            &#123;</span><br><span class="line">                edges[pre[i]].w -= flow[t];</span><br><span class="line">                edges[pre[i] ^ <span class="number">1</span>].w += flow[t];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;max_flow,min_cost&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">// namespace MCMF</span></span><br><span class="line"><span class="type">int</span> req[maxn];</span><br><span class="line"><span class="type">int</span> N;</span><br><span class="line"><span class="type">int</span> p,m,f,n,s;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> inf=<span class="number">0x3f3f3f3f</span>;</span><br><span class="line">    cin&gt;&gt;N;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cin&gt;&gt;req[i];</span><br><span class="line">    &#125;</span><br><span class="line">    cin&gt;&gt;p&gt;&gt;m&gt;&gt;f&gt;&gt;n&gt;&gt;s;</span><br><span class="line">    MCMF::s=<span class="number">0</span>;</span><br><span class="line">    MCMF::t=maxn<span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> base=(i<span class="number">-1</span>)*<span class="number">2</span>;</span><br><span class="line">        MCMF::<span class="built_in">add</span>(<span class="number">0</span>,base+<span class="number">1</span>,req[i],p);</span><br><span class="line">        MCMF::<span class="built_in">add</span>(base+<span class="number">1</span>,MCMF::t,req[i],<span class="number">0</span>);</span><br><span class="line">        MCMF::<span class="built_in">add</span>(base+<span class="number">1</span>,base+<span class="number">1</span>+<span class="number">2</span>,inf,<span class="number">0</span>);</span><br><span class="line">        MCMF::<span class="built_in">add</span>(<span class="number">0</span>,base+<span class="number">2</span>,req[i],<span class="number">0</span>);</span><br><span class="line">        <span class="comment">// Link to Washing room</span></span><br><span class="line">        MCMF::<span class="built_in">add</span>(base+<span class="number">2</span>,base+<span class="number">1</span>+(<span class="number">2</span>*m),inf,f);</span><br><span class="line">        MCMF::<span class="built_in">add</span>(base+<span class="number">2</span>,base+<span class="number">1</span>+(<span class="number">2</span>*n),inf,s);</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;MCMF::<span class="built_in">MFMC</span>().second&lt;&lt;std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/04/29/ICPC/%E6%90%9C%E7%B4%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/a1.jpg">
      <meta itemprop="name" content="Htto">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Htto的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/29/ICPC/%E6%90%9C%E7%B4%A2/" class="post-title-link" itemprop="url">搜索</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-29 12:34:08" itemprop="dateCreated datePublished" datetime="2021-04-29T12:34:08+08:00">2021-04-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-15 13:55:05" itemprop="dateModified" datetime="2024-06-15T13:55:05+08:00">2024-06-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/%E6%90%9C%E7%B4%A2/" itemprop="url" rel="index"><span itemprop="name">搜索</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>[toc]</p>
<h2 id="深度优先搜索">深度优先搜索</h2>
<h3 id="简介">简介</h3>
<p>DFS全称深度优先搜索，<strong>Depth First
Search</strong>，是一种通用性十分强的算法，算法竞赛中的暴力流，使用计算机强大的计算能力，穷举所有情况然后逐一判断该情况是否符合要求。</p>
<h3 id="棋盘连通性问题">棋盘连通性问题</h3>
<p>前置知识，四连通和八连通。</p>
<ul>
<li><strong>四连通</strong>：在四连通的条件下，两个格子相邻当且仅当它们的有相邻边。（即一个格子和上下左右连通）</li>
<li><strong>八连通</strong>，在八连通的条件下，两个格子相邻当且仅当它们有相邻的边或相邻的点（即一个格子的上下左右已经斜边四个角）</li>
</ul>
<p><img src="src\1.png" /></p>
<p>如图，在四连通的条件下，黄色块和蓝色块相邻，但是黄色块和白色块不相邻。在八连通的条件下，黄色块和蓝色块以及白色块都相邻。</p>
<h4 id="油田"><a
target="_blank" rel="noopener" href="http://oj.merdog.cn/#/submit?id=21&amp;where=topic">油田</a></h4>
<p>题目大意:</p>
<p>输入一个<span class="math inline">\(n\)</span>行<span
class="math inline">\(m\)</span>列的字符矩阵，统计字符"@"组成多少个八连块。如果两个字符"@"所在的格子相邻（横、竖或者对角线方向），就说它们属于同一个八连块。</p>
<p><strong>输入</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">5 5</span><br><span class="line">****@</span><br><span class="line">*@@*@</span><br><span class="line">*@**@</span><br><span class="line">@@@*@</span><br><span class="line">@@**@</span><br></pre></td></tr></table></figure>
<p><strong>输出</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2</span><br></pre></td></tr></table></figure>
<p>所谓连块，想象一个水塘，互相连接组成一个大的块，我们称为连块。</p>
<p>如果计算连块的数量呢，我们可以脑动模拟一下，如果你站在一个油田先把它占了，你的四周如果有油田的话，你可以派自己的分身把它们占了，到了新的的油田，继续搜寻周围，然后往复，知道所有我们能到达的油田都被我们占了。这样这个地方就是一个连通块，那么继续全局找其它油田。</p>
<p>我们很容易想到一个递归算法(伪代码)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义search(x,y)为搜寻位置为(x,y)的油田</span></span><br><span class="line"><span class="comment">// tag 表示之前是否占领过</span></span><br><span class="line"><span class="built_in">search</span>(x,y)</span><br><span class="line">    <span class="comment">// 一定要注意，跳出格子了，我们跳过</span></span><br><span class="line">    <span class="keyword">if</span>(x &lt;<span class="number">1</span> || x&gt;n || y&lt;<span class="number">1</span> || y&gt;m)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// 如果这一片不是油田，我们直接跳过，这里以前占领国，我们也跳过</span></span><br><span class="line"> 	<span class="keyword">if</span> M[x,y] != <span class="string">&#x27;@&#x27;</span> || tag[x,y]</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">       </span><br><span class="line">    <span class="comment">// 标记一下这里被占领了</span></span><br><span class="line">    tag[x,y]=<span class="literal">true</span>;</span><br><span class="line">    <span class="comment">// 然后往四个方向尝试</span></span><br><span class="line">	<span class="built_in">search</span>(x+<span class="number">1</span>,y);</span><br><span class="line">    <span class="built_in">search</span>(x,y+<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">search</span>(x<span class="number">-1</span>,y);</span><br><span class="line">    <span class="built_in">search</span>(x,y<span class="number">-1</span>);</span><br></pre></td></tr></table></figure>
<p>那么我们如何计数呢，如果我们发现一个新的之前没有找到过，那么我们计数器就+1,为什么，因为你如果寻找一个油田的时候，你会把周围它相连的所有油田都找遍。如果你发现一个新油田，那么肯定和之前的油田不相连。</p>
<p>代码</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">105</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">char</span> M[maxn][maxn];</span><br><span class="line"><span class="type">int</span> tag[maxn][maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">search</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">1</span> || x &gt; n || y &lt; <span class="number">1</span> || y &gt; m)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (M[x][y] != <span class="string">&#x27;@&#x27;</span> || tag[x][y])</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    tag[x][y] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">search</span>(x + <span class="number">1</span>, y);</span><br><span class="line">    <span class="built_in">search</span>(x, y + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">search</span>(x - <span class="number">1</span>, y);</span><br><span class="line">    <span class="built_in">search</span>(x, y - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">char</span> <span class="title">getch</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isspace</span>(ch))</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">return</span> ch;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">            M[i][j] = <span class="built_in">getch</span>();</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (tag[i][j] || M[i][j] != <span class="string">&#x27;@&#x27;</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            ans++;</span><br><span class="line">            <span class="built_in">search</span>(i, j);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里解决的是四连通的问题，题目问的是八连通，我们当然可以写很多search。但是这样很麻烦。我们介绍两种方便的方法。</p>
<ol type="1">
<li><p>写好位移坐标,dx,dy</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> dx[] = &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">-1</span>&#125;;</span><br><span class="line"><span class="type">int</span> dy[] = &#123;<span class="number">0</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 然后就可以用循环快速生成八个坐标</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">        <span class="built_in">search</span>(x + dx[i], y + dy[i]);</span><br></pre></td></tr></table></figure></li>
<li><p>直接二重循环（注意对四连通不适用，四连通用法1，或依次枚举）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (tag[i][j] || M[i][j] != <span class="string">&#x27;@&#x27;</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        ans++;</span><br><span class="line">        <span class="built_in">search</span>(i, j);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="摆格子问题">摆格子问题</h3>
<h4 id="全排列"><a
target="_blank" rel="noopener" href="http://oj.merdog.cn/#/submit?id=16">全排列</a></h4>
<p>排列(<strong>permutation</strong>)定义：对于一个<span
class="math inline">\(n\)</span>个数的数组，如果1到n的整数都能从该数组找到，我们称这个数组为一个排列。比如长度为3的排列有六个。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1 2 3</span><br><span class="line">1 3 2</span><br><span class="line">3 1 2</span><br><span class="line">3 2 1</span><br><span class="line">2 1 3</span><br><span class="line">2 3 1</span><br></pre></td></tr></table></figure>
<p>全排列(<strong>all permutation</strong>)定义：全排列就是把长度为<span
class="math inline">\(n\)</span>的所有可能的排列都列举出来。</p>
<p>长度为<span class="math inline">\(n\)</span>的排列有:<span
class="math inline">\(n!\)</span>种，我们运用小学的数学知识可以简单算出。</p>
<p>下面我们来考虑一个问题，给定长度<span
class="math inline">\(n\)</span>，让你按字典序输出<span
class="math inline">\(n\)</span>的全排列，即长度为<span
class="math inline">\(n\)</span>的所有排列。</p>
<ol type="1">
<li><p>首先思考，我们人脑是怎么枚举排列的，我们一般是不是先固定第一位数比如第一个数为1，然后继续枚举下面的，下面的方法就是基于这个思想，先处理完当前可能填写的情况，然后递归处理后面的数。</p></li>
<li><p>我们下面把要生成的<span
class="math inline">\(n\)</span>个数看成<span
class="math inline">\(n\)</span>个格子，我们目标就是把<span
class="math inline">\(n\)</span>个数填到这<span
class="math inline">\(n\)</span>个格子里。</p></li>
<li><p>我们开始编写递归的代码，首先递归的参数设为当前要处理的格子的位置cur，然后递归的终止条件是当前位置超出了n，这时表明我们一个排列已经生成，可以直接打印出这个排列</p></li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">15</span>;</span><br><span class="line"><span class="type">int</span> P[maxn];</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> cur)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 枚举完了，注意不能写成&gt;=n，因为第n个格子也要放数</span></span><br><span class="line">    <span class="keyword">if</span> (cur &gt; n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, P[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="comment">// 千万不要忘记写return</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="4" type="1">
<li>特判下面我们要写上普通的情况，如果给你第cur个格子，你能填哪些数呢，我们可以1到n都填一下试试，然后递归到下一个格子。</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> cur)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 枚举完了，注意不能写成&gt;=n，因为第n个格子也要放数</span></span><br><span class="line">    <span class="keyword">if</span> (cur &gt; n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, P[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="comment">// 千万不要忘记写return</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 第cur个格子我们放上i</span></span><br><span class="line">        P[cur] = i;</span><br><span class="line">        <span class="comment">// 好了，当前的格子处理完了，我们通过递归转移到下一个格子</span></span><br><span class="line">        <span class="built_in">dfs</span>(cur + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 我们尝试枚举长度为4的全排列</span></span><br><span class="line">    n = <span class="number">4</span>;</span><br><span class="line">    <span class="comment">// 我们要从第一个格子开始处理</span></span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="5" type="1">
<li><p>运行一下我们发现它枚举的不是全排列，而是所有1到n的数组组合，为什么我们看我们把<span
class="math inline">\(i\)</span>放到第cur个格子的时候没有检查<span
class="math inline">\(i\)</span>是否在之前的格子里出现过，一个全排列一个数字只能出现一次。那么我们可以简单修改一下</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> cur)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 枚举完了，注意不能写成&gt;=n，因为第n个格子也要放数</span></span><br><span class="line">    <span class="keyword">if</span> (cur &gt; n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, P[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="comment">// 千万不要忘记写return</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 我们来看看前面的格子有没有出现过i，出现了cur个格子不能放i了，我们就跳过.</span></span><br><span class="line">        <span class="type">bool</span> ok = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>; k &lt; cur; k++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (P[k] == i)</span><br><span class="line">            &#123;</span><br><span class="line">                ok = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!ok)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="comment">// 第cur个格子我们放上i</span></span><br><span class="line">        P[cur] = i;</span><br><span class="line">        <span class="comment">// 好了，当前的格子处理完了，我们通过递归转移到下一个格子</span></span><br><span class="line">        <span class="built_in">dfs</span>(cur + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<p>上面的代码已经足够通过班级里的题目了，但是上面的代码不够快，我们观察一下检测前面格子是否出现<span
class="math inline">\(i\)</span>这一步用了一个循环，我们其实可以用vis技术，来常数时间判断，代码如下。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> cur)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 枚举完了，注意不能写成&gt;=n，因为第n个格子也要放数</span></span><br><span class="line">    <span class="keyword">if</span> (cur &gt; n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, P[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="comment">// 千万不要忘记写return</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[i])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        P[cur] = i;</span><br><span class="line">        <span class="comment">// 说明P里面有i了</span></span><br><span class="line">        vis[i] = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(cur + <span class="number">1</span>);</span><br><span class="line">        <span class="comment">// 注意dfs完后我们要把i归还，因为我们会在这个格子上填其它数</span></span><br><span class="line">        vis[i] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="八皇后问题"><a
target="_blank" rel="noopener" href="http://oj.merdog.cn/#/submit?id=P1028&amp;where=topic">八皇后问题</a></h4>
<p>下面我们来看一个非常经典的问题，八皇后难题</p>
<blockquote>
<p>一个如下的 <span class="math inline">\(6×6\)</span>
的跳棋棋盘，有六个棋子被放置在棋盘上，使得每行、每列有且只有一个，每条对角线（包括两条主对角线的所有平行线）上至多有一个棋子。
<img src="https://cdn.luogu.com.cn/upload/pic/60.png" alt="avatar" />
上面的布局可以用序列 2 4 6 1 3 5 来描述，第 ii 个数字表示在第 ii
行的相应位置有一个棋子，如下：</p>
<p>行号 1 2 3 4 5 6</p>
<p>列号 2 4 6 1 3 5</p>
<p>这只是棋子放置的一个解。请编一个程序找出所有棋子放置的解。
并把它们以上面的序列方法输出，解按字典顺序排列。 请输出前 3
个解。最后一行是解的总个数。</p>
</blockquote>
<p>这好像是一个升级版的全排列，其实我们要做的还是摆格子，第<span
class="math inline">\(i\)</span>个格子表示第<span
class="math inline">\(i\)</span>行皇后需要摆放的位置，格子里填的数表示皇后的列坐标。因为八皇后问题不会出现一列放两个皇后的情况，即不会出现两个格子填了相同的数，这正好是一个排列，但是还需要满足斜线不能冲突。所以这题就是全排列plus
，全排列条件+八皇后特有斜线不能冲突条件。</p>
<p>如果你填好了一组数，你怎么看有没有斜线冲突呢，我们初中就学过一次函数的图像，我们这里可以借助这种思想（注意对于棋盘我们一般不采用笛卡尔坐标系，而是使用行列来表示一个位置），我们发现同一个斜线它们行号减去列号好像是一个定值，反斜线行号加上列号也是一个定值。利用这个简单的数学规律我们简单修改一下全排列的代码，只多加了两个数组vis2,vis3来判定两条斜线是否被占用。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> P[maxn];</span><br><span class="line"><span class="type">int</span> vis[maxn];</span><br><span class="line"><span class="type">int</span> vis2[maxn];</span><br><span class="line"><span class="type">int</span> vis3[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> cur)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (cur &gt; n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, P[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[i] || vis2[i - cur] || vis3[i + cur])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        P[cur] = i;</span><br><span class="line">        vis[i] = <span class="number">1</span>;</span><br><span class="line">        vis2[i - cur] = <span class="number">1</span>;</span><br><span class="line">        vis3[i + cur] = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(cur + <span class="number">1</span>);</span><br><span class="line">        vis[i] = <span class="number">0</span>;</span><br><span class="line">        vis2[i - cur] = <span class="number">0</span>;</span><br><span class="line">        vis3[i + cur] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>等等，我们<span class="math inline">\(i-cur\)</span>，<span
class="math inline">\(i+cur\)</span>好像会越界，<span
class="math inline">\(i-cur\)</span>会变成一个负数，那该这么办呢，<span
class="math inline">\(i-cur \in
\{1-n...n-1\}\)</span>，我们可以使用加一个偏移量<span
class="math inline">\(bias\)</span>，<span
class="math inline">\(i-cur+bias\)</span>大于<span
class="math inline">\(0\)</span>。</p>
<p>注意题目只要输出前3组解，完整代码如下</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">15</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> bias = <span class="number">50</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> P[maxn];</span><br><span class="line"><span class="type">int</span> vis[maxn];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> vis2[<span class="number">150</span>];</span><br><span class="line"><span class="type">int</span> vis3[<span class="number">150</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> cur)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (cur &gt; n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, P[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[i] || vis2[i - cur + bias] || vis3[i + cur])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        P[cur] = i;</span><br><span class="line">        vis[i] = <span class="number">1</span>;</span><br><span class="line">        vis2[i - cur + bias] = <span class="number">1</span>;</span><br><span class="line">        vis3[i + cur] = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(cur + <span class="number">1</span>);</span><br><span class="line">        vis[i] = <span class="number">0</span>;</span><br><span class="line">        vis2[i - cur + bias] = <span class="number">0</span>;</span><br><span class="line">        vis3[i + cur] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    n = <span class="number">8</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="货物摆放"><a
target="_blank" rel="noopener" href="http://oj.merdog.cn/#/submit?id=lq1002&amp;where=topic">货物摆放</a></h4>
<blockquote>
<p>小蓝有一个超大的仓库，可以摆放很多货物。 现在，小蓝有 n
箱货物要摆放在仓库，每箱货物都是规则的正方体。小蓝规定了长、宽、高三个互相垂直的方向，每箱货物的边都必须严格平行于长、宽、高。
小蓝希望所有的货物最终摆成一个大的立方体。即在长、宽、高的方向上分别堆
L、W、H 的货物，满足 <span class="math inline">\(n\)</span> = L × W ×
H。给定 n，请问有多少种堆放货物的方案满足要求。</p>
<p>例如，当 <span class="math inline">\(n = 4\)</span> 时，有以下 6
种方案：<span class="math inline">\(1×1×4、1×2×2、1×4×1、2×1×2、
2 × 2 × 1、4 × 1 × 1\)</span>。 请问，当 <span class="math inline">\(n =
2021041820210418\)</span> （注意有 16 位数字）时，总共有多少种方案？</p>
</blockquote>
<p>我们首先<span class="math inline">\(\sqrt
n\)</span>求出所有因子，然后还是填方格。这里我们就是填上它的因子（可以重复），最后检查填的乘积是否等于那个数就行，但是因子可能很大，乘起来会溢出，那么我们可以在算的过程中计算出已经得到的乘积<span
class="math inline">\(prod\)</span> ，这样剩下的格子成绩要是<span
class="math inline">\(V/prod\)</span>，我们要填入格子的因子一定是<span
class="math inline">\(V/prod\)</span>的因数（想想为什么）。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> i64 long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e2</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n = <span class="number">3</span>;</span><br><span class="line">i64 V = <span class="number">2021041820210418</span>;</span><br><span class="line">i64 A[maxn];</span><br><span class="line">i64 prod = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="comment">// 因子</span></span><br><span class="line">vector&lt;i64&gt; factors;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    factors.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">    factors.<span class="built_in">push_back</span>(V);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i64 i = <span class="number">2</span>; i * i &lt;= V; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (i * i == V)</span><br><span class="line">        &#123;</span><br><span class="line">            factors.<span class="built_in">push_back</span>(i);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (V % i == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            factors.<span class="built_in">push_back</span>(i);</span><br><span class="line">            factors.<span class="built_in">push_back</span>(V / i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(factors.<span class="built_in">begin</span>(), factors.<span class="built_in">end</span>());</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> cur)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (cur &gt; n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (prod == V)</span><br><span class="line">        &#123;</span><br><span class="line">            ++cnt;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>, A[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> f : factors)</span><br><span class="line">    &#123;</span><br><span class="line">        i64 r = V / prod;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (r % f != <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        A[cur] = f;</span><br><span class="line">        prod *= f;</span><br><span class="line">        <span class="built_in">dfs</span>(cur + <span class="number">1</span>);</span><br><span class="line">        prod /= f;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Number is %lld\n&quot;</span>, cnt);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>拓展练习：</p>
<ol type="1">
<li>如果不允许出现重复因子该怎么做</li>
<li>如果要保证后面的数大于前面的数又该怎么做。</li>
</ol>
<h4 id="方格填数"><a
target="_blank" rel="noopener" href="http://oj.merdog.cn/#/submit?id=lq1002&amp;where=topic">方格填数</a></h4>
<p>考虑该如何处理二维的情况</p>
<h3 id="选和不选类">选和不选类</h3>
<h4 id="dfs实现子集枚举">DFS实现子集枚举</h4>
<p>给定一个集合，枚举所有可能的子集我们也可以通过dfs来实现。</p>
<p>首先我们需要知道的是如果一个集合中有<span
class="math inline">\(n\)</span>个元素，它有<span
class="math inline">\(2^n\)</span>个子集，有<span
class="math inline">\(2^n-1\)</span>个非空子集。</p>
<p>我们发现子集的长度都不是固定的，比如对于集合<span
class="math inline">\(\{1,2,3\}\)</span>子集的数量有<span
class="math inline">\(2^3\)</span>个非空子集有<span
class="math inline">\(2^3-1\)</span>，即<span
class="math inline">\(\{1\},\{2\},\{3\},\{1,2\},\{2,3\},\{1,3\},\{1,2,3\}\)</span>这么多非空子集。</p>
<p>我们观察发现子集的最长的长度是固定的，它不会超过集合元素的个数，那么我们可以把格子放大一点能容纳下元素个数最大的集合，并且允许一些格子为空。就像这样<span
class="math inline">\(\{1,-1,-1\},\{-1,2,-1\},\{-1,-1,3\},\{1,2,-1\},\{-1,2,3\},\{1,-1,3\},\{1,2,3\}\)</span>(这里我们-1当成这个格子为空的特殊标志，当然这个数你也可以记作0，只要不与给定的集合元素冲突即可)</p>
<p>这样我们摆每个格子的时候只有两种决策，<strong>选和不选</strong>。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">vector&lt;<span class="type">int</span>&gt; Set = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这次我们从0号格子开始摆</span></span><br><span class="line"><span class="type">int</span> A[<span class="number">15</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> cur)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (cur &gt;= Set.<span class="built_in">size</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; Set.<span class="built_in">size</span>(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (A[i] == <span class="number">-1</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d,&quot;</span>, A[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    A[cur] = Set[cur];</span><br><span class="line">    <span class="built_in">dfs</span>(cur + <span class="number">1</span>);</span><br><span class="line">    A[cur] = <span class="number">-1</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(cur + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们其实可以进一步简化，使用vector的pop_back，我们根本不需要填充-1，如果选这个元素我们就push这个元素到A的末尾，如果不选我们直接往下搜即可，注意我们一定别忘记选中这种情况执行完了切换到不选的时候要pop_back，dfs(cur+1)后我们要保证变回原样。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; Set = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这次我们从0号格子开始摆</span></span><br><span class="line">vector&lt;<span class="type">int</span>&gt; A;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> cur)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (cur &gt;= Set.<span class="built_in">size</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> v : A)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, v);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 选它</span></span><br><span class="line">    A.<span class="built_in">push_back</span>(Set[cur]);</span><br><span class="line">    <span class="built_in">dfs</span>(cur + <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// 一定别忘记选中这种情况执行完了切换到不选的时候要pop_back</span></span><br><span class="line">    A.<span class="built_in">pop_back</span>();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">dfs</span>(cur + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="平衡括号计数"><a
target="_blank" rel="noopener" href="http://oj.merdog.cn/#/submit?id=Y1010&amp;competeid=21&amp;index=5&amp;where=topic">平衡括号计数</a></h4>
<blockquote>
<p>给定一个数<span
class="math inline">\(n\)</span>你需要找出所有满足以下条件的字符串</p>
<ul>
<li><p>字符串长度为<span class="math inline">\(n\)</span></p></li>
<li><p>字符串只包含<code>(</code>和<code>)</code>两种字符</p></li>
<li><p>该字符串满足括号平衡。</p></li>
</ul>
<p>你只需要输出满足条件的字符串的<strong>个数</strong>，不需要输出所有字符串</p>
<p>例如: <code>()</code>,<code>(()())</code>括号平衡,
而<code>)((</code>,<code>(()))(</code>括号不平衡</p>
</blockquote>
<p>首先我们考虑如何判断一串括号是否平衡，括号平衡需要满足两个基本条件</p>
<ul>
<li>左括号的数量和右括号的数量相同</li>
<li>记: <span class="math inline">\(f(x)\)</span>为第一个字符到第<span
class="math inline">\(x\)</span>个字符，左括号数量和右括号的差，比如<code>(()(</code>
<span
class="math inline">\(f(1)=1,f(2)=2,f(3)=1,f(4)=2\)</span>，如果括号平衡一定要满足<span
class="math inline">\(\forall x\in \{1...|s|\},f(x)\ge
0\)</span>其中<span
class="math inline">\(|s|\)</span>为字符串的长度。</li>
</ul>
<p>第一个条件十分显然，我们可以证明第二条，我们使用反证法如果<span
class="math inline">\(\exists x, f(x)&lt;0\)</span>即表明前<span
class="math inline">\(x\)</span>字符中右括号的数量比左括号的数量多，那么一定会有一个右括号得不到配对，而<span
class="math inline">\(x\)</span>后面的左括号不能和前面的右括号配对，所以这个字符串括号一定不平衡。</p>
<p><strong>检测括号平衡函数</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1005</span>;</span><br><span class="line"><span class="comment">// 字符串从str[1]开始</span></span><br><span class="line"><span class="type">char</span> str[maxn];</span><br><span class="line"><span class="type">int</span> n = <span class="number">4</span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (str[i] == <span class="string">&#x27;(&#x27;</span>)</span><br><span class="line">            sum++;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            sum--;</span><br><span class="line">        <span class="keyword">if</span> (sum &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>那么我们这么才能枚举所有可能的字符串呢，发现它的长度是固定的，而且每个位置只能出现<code>(</code>和<code>)</code>，我们直接把两种决策放到str即可，最后生成了一个字符串后检测是否符合条件。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> cur)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (cur &gt; n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">check</span>())</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, str + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    str[cur] = <span class="string">&#x27;(&#x27;</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(cur + <span class="number">1</span>);</span><br><span class="line">    str[cur] = <span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(cur + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="选数"><a
target="_blank" rel="noopener" href="http://oj.merdog.cn/#/submit?id=P1029&amp;where=topic">选数</a></h4>
<blockquote>
<p>已知 n 个整数 <span
class="math inline">\(x_1,x_2,\cdots,x_n\)</span>，以及 11 个整数 <span
class="math inline">\(k(k&lt;n)\)</span>。从 <span
class="math inline">\(n\)</span> 个整数中任选 <span
class="math inline">\(k\)</span>
个整数相加，可分别得到一系列的和。例如当 <span
class="math inline">\(n=4\)</span>，<span
class="math inline">\(k=3\)</span>，<span
class="math inline">\(4\)</span> 个整数分别为 <span
class="math inline">\(3,7,12,19\)</span>
时，可得全部的组合与它们的和为：</p>
<p><span class="math inline">\(3+7+12=22\)</span></p>
<p><span class="math inline">\(3+7+19=29\)</span></p>
<p><span class="math inline">\(7+12+19=38\)</span></p>
<p><span class="math inline">\(3+12+19=34\)</span></p>
<p>现在，要求你计算出和为素数共有多少种。</p>
<p>例如上例，只有一种的和为素数：<span
class="math inline">\(3+7+19=29\)</span>。</p>
</blockquote>
<p>使用子集枚举，最后验证是否选了<span
class="math inline">\(k\)</span>个并且该集合之和是否为素数即可。</p>
<h3 id="一些经典题目">一些经典题目</h3>
<h4 id="素数环"><a
target="_blank" rel="noopener" href="http://oj.merdog.cn/#/submit?id=2001">素数环</a></h4>
<blockquote>
<p>A ring is composed of n (even number) circles as shown in diagram.
Put natural numbers 1, 2, . . . , n into each circle separately, and the
sum of numbers in two adjacent circles should be a prime. Note: the
number of first circle should always be 1.</p>
<p>题目大意就是让你把1...n这n个数串成一个环，使得任意两个相邻的数和为素数。(首位必须为1)</p>
</blockquote>
<figure>
<img
src="https://ss1.baidu.com/9vo3dSag_xI4khGko9WTAnF6hhy/baike/pic/item/faf2b2119313b07ecb2b3bb80bd7912396dd8cef.jpg"
alt="pic" />
<figcaption aria-hidden="true">pic</figcaption>
</figure>
<p>这一题我们还是暴力摆格子，注意首位加末位需要是素数，我们可以摆完后特判首位是否互素即可。</p>
<p>容易得到解法</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> A[<span class="number">15</span>];</span><br><span class="line"><span class="type">int</span> vis[<span class="number">15</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> cur)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (cur &gt; n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">is_prime</span>(A[<span class="number">1</span>] + A[n]))</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, A[i]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (cur == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        A[cur] = <span class="number">1</span>;</span><br><span class="line">        vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">dfs</span>(cur + <span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">        vis[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (vis[i])</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">is_prime</span>(i + A[cur - <span class="number">1</span>]))</span><br><span class="line">            &#123;</span><br><span class="line">                A[cur] = i;</span><br><span class="line">                vis[i] = <span class="number">1</span>;</span><br><span class="line">                <span class="built_in">dfs</span>(cur + <span class="number">1</span>);</span><br><span class="line">                vis[i] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="一笔画"><a
target="_blank" rel="noopener" href="http://oj.merdog.cn/#/submit?id=P1030">一笔画</a></h4>
<p>一天小明在玩一个叫一笔画的游戏，遇到了一些不会的关卡。游戏内容是这样的。给你<span
class="math inline">\(n\)</span>行<span
class="math inline">\(m\)</span>（<span class="math inline">\(1\le n,m
\le
20\)</span>）列的地图，S代表起点，.代表道路，#代表障碍物不能通过。小明想知道能不能一笔通过所有道路。</p>
<p>这种找出每个点都经过且都经过一次的路径我们称为<strong>哈密顿路径</strong>。哈密顿路径求解是一个<span
class="math inline">\(NP\)</span>问题，即我们没有多项式时间复杂度的算法。那么我们就可以安心的使用暴力了。</p>
<p>我们只要在每个点枚举四个方向走就行。时间复杂度是<span
class="math inline">\(4^{nm}\)</span>，但是因为我们只要找到一组解，所以跑起来远远没到<span
class="math inline">\(4^{nm}\)</span>规定时间内可以求出。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> vis[maxn][maxn];</span><br><span class="line"><span class="type">char</span> M[maxn][maxn];</span><br><span class="line"><span class="type">int</span> sx, sy;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> dir[] = <span class="string">&quot;LRUD&quot;</span>;</span><br><span class="line"><span class="type">int</span> dx[] = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">1</span>&#125;;</span><br><span class="line"><span class="type">int</span> dy[] = &#123;<span class="number">-1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> white_cnt = <span class="number">0</span>;</span><br><span class="line"><span class="type">char</span> A[<span class="number">150</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> depth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (depth == white_cnt)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        A[depth] = dir[i];</span><br><span class="line">        <span class="type">int</span> nx = x + dx[i], ny = y + dy[i];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (vis[nx][ny] || M[nx][ny] == <span class="string">&#x27;#&#x27;</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (nx &lt;= <span class="number">0</span> || nx &gt; n || ny &lt;= <span class="number">0</span> || ny &gt; m)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        vis[nx][ny] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">dfs</span>(nx, ny, depth + <span class="number">1</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        vis[nx][ny] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="宽度优先搜索">宽度优先搜索</h2>
<h3 id="一些经典问题">一些经典问题</h3>
<p>之前我们讲的DFS，都是枚举完一个解后再判断，DFS重点是枚举完了再判断处理。如果要找出步数最少的解我们就需要枚举所有可能，这样时间复杂度便是指数级，更可怕的是枚举过程中步数会不固定，可能会非常长，这样我们就无法在规定的时间内解决问题。</p>
<p>这时我们不妨换个思路，如果有一种算法可以先枚举第一步能到达的所有状态，检查完发现都无法满足条件，我们从第一步出发枚举所有走两步可以到达的状态是否有某一个状态能满足条件，这样一直枚举下去直到发现一组解，这组解一定使用了最少的步数。这样我们便可以不用枚举所有解了，而是根据把某一步数的所有状态都穷举完，在基于这一步向下一步迈进。</p>
<p>我们称之为BFS，你可以认为BFS是一层一层的搜索，而不是DFS先搜到底，然后回退到上一个状态继续找其它解。</p>
<h4 id="迷宫问题"><a
target="_blank" rel="noopener" href="http://oj.merdog.cn/#/submit?id=P1033&amp;where=prolist">迷宫问题</a></h4>
<p>给你一个迷宫，起点为S，终点为T，.表示空格，#表示障碍物无法通过，你每次可以从当前位置上下左右移动（不能出界或者撞到障碍物上）你需要找出从起点到终点的最少步数，如果不存在解，输出-1。</p>
<p>第一行输入<span class="math inline">\(n,(1\le n \le 100), m(1\le m
\le 100)\)</span>表示迷宫的行数和列数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">5 5</span><br><span class="line">.....</span><br><span class="line">...S.</span><br><span class="line">####.</span><br><span class="line">..T#.</span><br><span class="line">.....</span><br></pre></td></tr></table></figure>
<p>答案是7.</p>
<p>我们用dfs可以快速判断是否有解，只要S和T在同一个四连块，那么S就一定可以到达T。我们也可以dfs穷举所有路径，然后找到一条长度最短的一条。时间复杂度<span
class="math inline">\(O(4^{nm})\)</span>注意我们第三个参数depth，当然我们也可以写成全局变量，这个记录了你当前搜索的深度（即步数）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> ans = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">char</span> M[maxn][maxn];</span><br><span class="line"><span class="type">int</span> vis[maxn][maxn];</span><br><span class="line"><span class="type">int</span> sx, sy, ex, ey;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> dx[] = &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">int</span> dy[] = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>&#125;;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check_pos</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &gt;= <span class="number">1</span> &amp;&amp; x &lt;= n &amp;&amp; y &gt;= <span class="number">1</span> &amp;&amp; y &lt;= n &amp;&amp; !vis[x][y] &amp;&amp; M[x][y] != <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> depth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == ex &amp;&amp; y == ey)</span><br><span class="line">    &#123;</span><br><span class="line">        ans = <span class="built_in">min</span>(ans, depth);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> nx = x + dx[i], ny = y + dy[i];</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">check_pos</span>(nx, ny))</span><br><span class="line">        &#123;</span><br><span class="line">            vis[nx][ny] = <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">dfs</span>(nx, ny, depth + <span class="number">1</span>);</span><br><span class="line">            vis[nx][ny] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            cin &gt;&gt; M[i][j];</span><br><span class="line">            <span class="keyword">if</span> (M[i][j] == <span class="string">&#x27;S&#x27;</span>)</span><br><span class="line">                sx = i, sy = j;</span><br><span class="line">            <span class="keyword">if</span> (M[i][j] == <span class="string">&#x27;T&#x27;</span>)</span><br><span class="line">                ex = i, ey = j;</span><br><span class="line">        &#125;</span><br><span class="line">    vis[sx][sy] = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(sx, sy, <span class="number">0</span>);</span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这种方法对于很小的地图<span class="math inline">\(5\times
5\)</span>以内，还是有可能解决的对于<span class="math inline">\(10\times
10\)</span>这种棋盘如果障碍物不多感觉就跑不出来了。其实我们这里可以简单优化一下，如果当前深度超过了已有的解，直接退出。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> depth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(depth &gt;= ans)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (x == ex &amp;&amp; y == ey)</span><br><span class="line">    &#123;</span><br><span class="line">        ans = <span class="built_in">min</span>(ans, depth);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	....</span><br></pre></td></tr></table></figure>
<p>这种优化称为剪枝，可以大幅度提高dfs的速度，但是这种提升还是敌不过指数大一点所带来的运行时间膨胀，我们需要另寻他法。BFS，</p>
<p>我们考虑怎么才能实现bfs，一层一层的搜索，也就是先搜第一步能达到那些格子，然后从这第一步出发再走一步即第二部能到达那些格子，直到我们跑遍了所有我们能走到的格子。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// A[i] 表示第i步能到达哪些格子.</span></span><br><span class="line">vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; A[<span class="number">10005</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    A[<span class="number">0</span>].<span class="built_in">push_back</span>(&#123;sx, sy&#125;);</span><br><span class="line">    <span class="comment">// 最多不会超过n*m-1步</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m * n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//我们每次都用当前步更新下一步。</span></span><br><span class="line">        <span class="comment">// C++ 17语法，结构化绑定，可以使用方括号依次对于迭代的每个元素成员，等价于</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        for(size_t i=0;i&lt;A[i].size();i++)</span></span><br><span class="line"><span class="comment">        &#123;</span></span><br><span class="line"><span class="comment">            int x=A[i].first;</span></span><br><span class="line"><span class="comment">            int y=A[i].second;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> [x, y] : A[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 从x,y出发在走一步，就是走了i+1步能到哪些地方</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> nx = x + dx[j], ny = y + dy[j];</span><br><span class="line">                <span class="keyword">if</span> (!<span class="built_in">check_pos</span>(nx, ny))</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                A[i + <span class="number">1</span>].<span class="built_in">push_back</span>(&#123;nx, ny&#125;);</span><br><span class="line">                <span class="comment">// 当前访问到了nx,ny，这已经是最优了，因为后面访问到了nx,ny一定不小于i+1步。</span></span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;vis[%d][%d]=%d\n&quot;</span>, nx, ny, i + <span class="number">1</span>);</span><br><span class="line">                vis[nx][ny] = i + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们把每一步能到达的点都存到了A中，基于第i步一定从i-1步转移过来的，我们一定不会漏解，但是vis的存在我们可以省去很多不必要的状态，比如我们本来<span
class="math inline">\(a\)</span>步和<span
class="math inline">\(b\)</span>步都能到达一个点，但是vis的存在会忽略到步数长的状态。时间复杂度<span
class="math inline">\(O(mn)\)</span>因为每个格子只访问一遍。</p>
<p>这个A数组看上去很蠢，其实我们可以使用队列来模拟bfs过程。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> ans = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">char</span> M[maxn][maxn];</span><br><span class="line"><span class="type">int</span> vis[maxn][maxn];</span><br><span class="line"><span class="type">int</span> sx, sy, ex, ey;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> dx[] = &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">int</span> dy[] = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check_pos</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &gt;= <span class="number">1</span> &amp;&amp; x &lt;= n &amp;&amp; y &gt;= <span class="number">1</span> &amp;&amp; y &lt;= n &amp;&amp; vis[x][y]==<span class="number">-1</span> &amp;&amp; M[x][y] != <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(&#123;sx, sy&#125;);</span><br><span class="line">    vis[sx][sy] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> [x, y] = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> nx = x + dx[j], ny = y + dy[j];</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">check_pos</span>(nx, ny))</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            q.<span class="built_in">push</span>(&#123;nx, ny&#125;);</span><br><span class="line">            vis[nx][ny] = vis[x][y] + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            cin &gt;&gt; M[i][j];</span><br><span class="line">            <span class="keyword">if</span> (M[i][j] == <span class="string">&#x27;S&#x27;</span>)</span><br><span class="line">                sx = i, sy = j;</span><br><span class="line">            <span class="keyword">if</span> (M[i][j] == <span class="string">&#x27;T&#x27;</span>)</span><br><span class="line">                ex = i, ey = j;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">-1</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line">    <span class="built_in">bfs</span>();</span><br><span class="line">    cout &lt;&lt; vis[ex][ey] &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="马的遍历"><a
target="_blank" rel="noopener" href="http://oj.merdog.cn/#/submit?id=P1032&amp;where=prolist">马的遍历</a></h4>
<blockquote>
<p>有一个 <span class="math inline">\(n \times m\)</span>
的棋盘，在某个点 (x, y)(<em>x</em>,<em>y</em>)
上有一个马，要求你计算出马到达棋盘上任意一个点最少要走几步。</p>
<p>输入只有一行四个整数，分别为 n, m, x, y。</p>
</blockquote>
<p>下面的题目就都是套这个bfs的模板了，首先我们先要想状态，棋盘类问题状态一般都是格子，然后我们看状态之间<strong>一步</strong>进行的转移。</p>
<p>由于马是走日字形的，首先将马的行走方式存储在数组中，通过dis数组记录所有的距离，直接BFS即可</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Point</span>&#123;</span><br><span class="line">    <span class="type">int</span> x, y, step;</span><br><span class="line">    <span class="built_in">Point</span>(<span class="type">int</span> _x, <span class="type">int</span> _y, <span class="type">int</span> _step):<span class="built_in">x</span>(_x), <span class="built_in">y</span>(_y), <span class="built_in">step</span>(_step)&#123;&#125;</span><br><span class="line">    <span class="built_in">Point</span>()&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//用于遍历的队列</span></span><br><span class="line">queue&lt;Point&gt; q;</span><br><span class="line"><span class="comment">//马一步能走的所有位置</span></span><br><span class="line"><span class="type">int</span> movex[<span class="number">8</span>] = &#123;<span class="number">2</span>,<span class="number">-2</span>,<span class="number">2</span>,<span class="number">-2</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">1</span>&#125;;</span><br><span class="line"><span class="type">int</span> movey[<span class="number">8</span>] = &#123;<span class="number">1</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">-2</span>,<span class="number">-2</span>&#125;;</span><br><span class="line"><span class="comment">//记录马走到每个点的步数</span></span><br><span class="line"><span class="type">int</span> dis[<span class="number">405</span>][<span class="number">405</span>];</span><br><span class="line"><span class="type">int</span> st_x, st_y, n, m;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">BFS</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//将dis初值赋值为-1同时可以起到vis的作用（避免重复搜素）</span></span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">0xff</span>, <span class="built_in">sizeof</span>(dis));</span><br><span class="line">    q.<span class="built_in">push</span>(<span class="built_in">Point</span>(st_x, st_y, <span class="number">0</span>));</span><br><span class="line">    dis[st_x][st_y] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        Point cur = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)&#123;</span><br><span class="line">            <span class="comment">//下一步的x坐标</span></span><br><span class="line">            <span class="type">int</span> nxtX = cur.x + movex[i];</span><br><span class="line">            <span class="comment">//下一步的y坐标</span></span><br><span class="line">            <span class="type">int</span> nxtY = cur.y + movey[i];</span><br><span class="line">            <span class="comment">//下一步一共走的步数</span></span><br><span class="line">            <span class="type">int</span> nxtStep = cur.step + <span class="number">1</span>;</span><br><span class="line">            <span class="comment">//检测坐标是否合法</span></span><br><span class="line">            <span class="keyword">if</span> (nxtX &gt;= <span class="number">1</span> &amp;&amp; nxtX &lt;= m &amp;&amp; nxtY &gt;= <span class="number">1</span> &amp;&amp; nxtY &lt;= n)&#123;</span><br><span class="line">                <span class="comment">//dis为-1说明还没有搜索过</span></span><br><span class="line">                <span class="keyword">if</span> (dis[nxtX][nxtY] == <span class="number">-1</span>)&#123;</span><br><span class="line">                    q.<span class="built_in">push</span>(<span class="built_in">Point</span>(nxtX, nxtY, nxtStep));</span><br><span class="line">                    dis[nxtX][nxtY] = nxtStep;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; st_y &gt;&gt; st_x;</span><br><span class="line">    <span class="built_in">BFS</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%-5d&quot;</span>, dis[j][i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="奇怪的电梯"><a
target="_blank" rel="noopener" href="http://oj.merdog.cn/#/submit?id=P1034&amp;where=prolist">奇怪的电梯</a></h4>
<blockquote>
<p>有一台电梯，他每层楼都只能向上或向下固定的层数<span
class="math inline">\(K_i\)</span>，比如<span
class="math inline">\(K_1=3\)</span>表示该电梯在一楼时只能向上3层或者向下3层（超过总楼层或者低于1楼的都属于无法到达）问从楼层A到楼层B需要的步数（若不存在则为-1）</p>
</blockquote>
<p>由于每层楼都只有固定的两个操作向上或者向下，因此我们可以从开始楼层A开始上下同时搜索，将合法的移动都添加到队列中，同时记录已经到达过的楼层，在搜索的同时检查一下是否到达楼层B即可，若为搜索到则返回-1。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;tuple&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> N, A, B;</span><br><span class="line"><span class="type">int</span> vis[maxn];</span><br><span class="line"><span class="type">int</span> K[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(&#123;A, <span class="number">0</span>&#125;);</span><br><span class="line">    vis[A] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> [p, t] = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span> (p == B)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> t;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 往上</span></span><br><span class="line">        <span class="type">int</span> np1 = p + K[p];</span><br><span class="line">        <span class="comment">// 往下</span></span><br><span class="line">        <span class="type">int</span> np2 = p - K[p];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1</span> &lt;= np1 &amp;&amp; np1 &lt;= N)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (vis[np1] == <span class="number">-1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                vis[np1] = t + <span class="number">1</span>;</span><br><span class="line">                q.<span class="built_in">push</span>(&#123;np1, t + <span class="number">1</span>&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1</span> &lt;= np2 &amp;&amp; np2 &lt;= N)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (vis[np2] == <span class="number">-1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                vis[np2] = t + <span class="number">1</span>;</span><br><span class="line">                q.<span class="built_in">push</span>(&#123;np2, t + <span class="number">1</span>&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; N &gt;&gt; A &gt;&gt; B;</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">-1</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= N; i++)</span><br><span class="line">        cin &gt;&gt; K[i];</span><br><span class="line">    cout &lt;&lt; <span class="built_in">bfs</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="meteor-shower"><a
target="_blank" rel="noopener" href="http://oj.merdog.cn/#/submit?id=P1036&amp;where=prolist">Meteor
Shower</a></h4>
<blockquote>
<p>陨石从不同时刻T（T &lt;=
1000）落下，每颗陨石会摧毁落点以及<b>周围相邻的四个方格</b>贝西从原点（0，0）出发，每走一步会花费一个时间单位，问贝西至少要走几步才能走到安全的地点（不会被陨石摧毁的方格）</p>
</blockquote>
<p>由于每颗陨石在不同的时刻落下，因此我们可以在地图上记录每个方块被最早被摧毁的时间（取最小值）若不会被摧毁则为<a
href="#fn1" class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a>，在bfs的时候记录当前走的步数，若下一步的时间<b>小于被摧毁的时间</b>则可以移动，同时判断是否为安全的方块如果是，则可以直接返回步数。</p>
<p>我们这里用两个vis来记录，vis代表这个格子被摧毁的时间，而vis2代表Bassie之前bfs过程中是否走过这个格子，走过就不要再走了（好牛不走回头路，因为在回头走的话时间复杂度就变成指数级）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;tuple&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> dx[] = &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">int</span> dy[] = &#123;<span class="number">0</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> vis[maxn][maxn];</span><br><span class="line"><span class="type">int</span> vis2[maxn][maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check_pos</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span> || x &gt; <span class="number">500</span> || y &lt; <span class="number">0</span> || y &gt; <span class="number">500</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;tuple&lt;<span class="type">int</span>, <span class="type">int</span>, <span class="type">int</span>&gt;&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;);</span><br><span class="line">    vis2[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> [x, y, t] = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (vis[x][y] &gt; <span class="number">1e9</span>)</span><br><span class="line">            <span class="keyword">return</span> t;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> nx = x + dx[i], ny = y + dy[i];</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">check_pos</span>(nx, ny) || vis2[nx][ny])</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (vis[nx][ny] &gt; t + <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                q.<span class="built_in">push</span>(&#123;nx, ny, t + <span class="number">1</span>&#125;);</span><br><span class="line">                vis2[nx][ny] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">0x3f</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x, y, t;</span><br><span class="line">        cin &gt;&gt; x &gt;&gt; y &gt;&gt; t;</span><br><span class="line">        vis[x][y] = <span class="built_in">min</span>(vis[x][y], t);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> nx = x + dx[j], ny = y + dy[j];</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">check_pos</span>(nx, ny))</span><br><span class="line">            &#123;</span><br><span class="line">                vis[nx][ny] = <span class="built_in">min</span>(vis[nx][ny], t);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">bfs</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="复杂状态的bfs">复杂状态的bfs</h3>
<h4 id="八数码难题"><a
target="_blank" rel="noopener" href="http://oj.merdog.cn/#/submit?id=P1035&amp;where=prolist">八数码难题</a></h4>
<blockquote>
<p>在3×3的棋盘上，摆有八个棋子，每个棋子上标有1至8的某一数字。棋盘中留有一个空格，空格用0来表示。空格周围的棋子可以移到空格中。要求解的问题是：给出一种初始布局（初始状态）和目标布局（为了使题目简单,设目标状态为123804765），找到一种最少步骤的移动方法，实现从初始布局到目标布局的转变。</p>
</blockquote>
<p>如何判断状态，3x3白块的位置？我们发现这个状态所含的信息是不完整的，因为你白块移动了还会影响到其它数字，告诉你一个小技巧，我们可以看我们需要到达哪里，题目中我们需要到达目标状态
<code>123804765</code>，这是一个字符串，我所以我们状态就定为这样的字符串，通过这个9个数字我们可以重建3x3的棋盘。然后移动白块形成新的状态作为下一步，这样我们朴素的bfs即可解决这个问题。</p>
<p>我们的代码直接按字符顺序充填棋盘，我们其实可以把这个字符串看作一个全排列（0看作1，1看作2以此类推），然后使用康托展开（相当于对一个排列哈希）来获取状态的整数编码，有关康托展开的内容这里就不在赘述。有兴趣的同学可以自行了解。</p>
<p>本题有许许多多的优化方法，常用的两种分别是双向搜索和启发式搜索，对于更大的棋盘比如12数码问题，我们的朴素bfs会超时，有关双向搜索和启发式搜索可以自行上网了解。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> M[<span class="number">3</span>][<span class="number">3</span>];</span><br><span class="line">set&lt;string&gt; vis;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> dx[] = &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">int</span> dy[] = &#123;<span class="number">0</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line"><span class="comment">// 将字符串转换为地图</span></span><br><span class="line"><span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">convert</span><span class="params">(<span class="type">const</span> std::string &amp;str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; ret;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; str.<span class="built_in">size</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        M[i / <span class="number">3</span>][i % <span class="number">3</span>] = str[i] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (str[i] == <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            ret = &#123;i / <span class="number">3</span>, i % <span class="number">3</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">string <span class="title">inv_convert</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    string ret;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; j++)</span><br><span class="line">            ret.<span class="built_in">push_back</span>(M[i][j] + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check_pos</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &gt;= <span class="number">0</span> &amp;&amp; x &lt; <span class="number">3</span> &amp;&amp; y &gt;= <span class="number">0</span> &amp;&amp; y &lt; <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">bfs</span><span class="params">(<span class="type">const</span> string &amp;start, <span class="type">const</span> string &amp;dest)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (start == dest)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    queue&lt;pair&lt;string, <span class="type">int</span>&gt;&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(&#123;start, <span class="number">0</span>&#125;);</span><br><span class="line">    vis.<span class="built_in">insert</span>(start);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> [cur, cnt] = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">auto</span> [x, y] = <span class="built_in">convert</span>(cur);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> nx = x + dx[i], ny = y + dy[i];</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">check_pos</span>(nx, ny))</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">swap</span>(M[nx][ny], M[x][y]);</span><br><span class="line">            string nxt = <span class="built_in">inv_convert</span>();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (nxt == dest)</span><br><span class="line">                <span class="keyword">return</span> cnt + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!vis.<span class="built_in">count</span>(nxt))</span><br><span class="line">            &#123;</span><br><span class="line">                vis.<span class="built_in">insert</span>(nxt);</span><br><span class="line">                q.<span class="built_in">push</span>(&#123;nxt, cnt + <span class="number">1</span>&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 一定别忘记换回来</span></span><br><span class="line">            <span class="built_in">swap</span>(M[nx][ny], M[x][y]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    string start;</span><br><span class="line">    cin &gt;&gt; start;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">bfs</span>(start, <span class="string">&quot;123804765&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="课后练习-扭密码箱">课后练习: <a
target="_blank" rel="noopener" href="http://oj.merdog.cn/#/submit?id=Y1009&amp;where=prolist">扭密码箱</a></h4>
<blockquote>
<p>你新买了一个密码箱，密码箱支持4位数密码，每一位都是数字0到9，这个密码箱是旋转式的，所以0下面一个是9，上面一个是1。刚买到箱子锁上显示0000，你知道它的密码，现在问你最少多少步可以将它解开。</p>
<p>每一步你都可以将相邻的几个数位往同一方向扭动一个格子，比如0000一步可以到达1111或者0111，0110，1100，0100，9999，0999等等，但是不能一步扭到0101或者0190,0200等不合法的状态.</p>
</blockquote>
<p>这题稍微麻烦了一点，但是还是很好想暴力BFS即可，把这个四位数看成一个状态，然后梳理好怎么转移跑bfs即可。</p>
<p>其实这是ICPC2021沈阳真题，是一道铜牌题。原题是一个状态扭到另一个状态，而且给了非常多组数据，其实我们只要写完这题，然后所有两个状态的距离可以转换为0扭到它们的之间的<strong>位差状态</strong>，简单来说<span
class="math inline">\(a\)</span>扭到<span
class="math inline">\(b\)</span>可以转化为<span
class="math inline">\(0\)</span>扭到<span
class="math inline">\(c\)</span>，而<span
class="math inline">\(c=b-a\)</span>(（不进位减法)。这样预处理可能花点时间，后面只要<span
class="math inline">\(O(1)\)</span>查表就得到了答案。</p>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>大于最大时间1000即可，为方便起见本题可设为0x3f3f3f3f<a
href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/04/29/ICPC/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%841/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/a1.jpg">
      <meta itemprop="name" content="Htto">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Htto的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/29/ICPC/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%841/" class="post-title-link" itemprop="url">数据结构</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-29 12:34:08" itemprop="dateCreated datePublished" datetime="2021-04-29T12:34:08+08:00">2021-04-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-15 13:55:05" itemprop="dateModified" datetime="2024-06-15T13:55:05+08:00">2024-06-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>[TOC]</p>
<h2 id="线段树模版">线段树模版</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">namespace</span> SegTree&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> maxn=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line">    <span class="type">int</span> dat[maxn],tree[maxn*<span class="number">4</span>],tag[maxn*<span class="number">4</span>];</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">lson</span><span class="params">(<span class="type">int</span> p)</span></span>&#123;<span class="keyword">return</span> <span class="number">2</span>*p;&#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">rson</span><span class="params">(<span class="type">int</span> p)</span></span>&#123;<span class="keyword">return</span> <span class="number">2</span>*p+<span class="number">1</span>;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">push_up</span><span class="params">(<span class="type">int</span> p)</span></span>&#123;</span><br><span class="line">        tree[p]=tree[<span class="built_in">lson</span>(p)]+tree[<span class="built_in">rson</span>(p)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">f</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        tag[p]+=v;</span><br><span class="line">        tree[p]+=(r-l+<span class="number">1</span>)*v;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">push_down</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> m=(l+r)/<span class="number">2</span>;</span><br><span class="line">        <span class="built_in">f</span>(<span class="built_in">lson</span>(p),l,m,tag[p]);</span><br><span class="line">        <span class="built_in">f</span>(<span class="built_in">rson</span>(p),m+<span class="number">1</span>,r,tag[p]);</span><br><span class="line">        tag[p]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l=<span class="number">1</span>,<span class="type">int</span> r=n,<span class="type">int</span> p=<span class="number">1</span>)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l==r)</span><br><span class="line">            tree[p]=dat[l];</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> m=(l+r)/<span class="number">2</span>;</span><br><span class="line">            <span class="built_in">build</span>(l,m,<span class="built_in">lson</span>(p));</span><br><span class="line">            <span class="built_in">build</span>(m+<span class="number">1</span>,r,<span class="built_in">rson</span>(p));</span><br><span class="line">            tree[p]=tree[<span class="built_in">lson</span>(p)]+tree[<span class="built_in">rson</span>(p)];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l &gt; R || r &lt; L) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span>(l&lt;=L &amp;&amp; r&gt;=R)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">f</span>(p,L,R,v);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">push_down</span>(p,L,R);</span><br><span class="line">        <span class="type">int</span> m=(L+R)/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span>(l &lt;= m) <span class="built_in">update</span>(<span class="built_in">lson</span>(p),l,r,L,m,v);</span><br><span class="line">        <span class="keyword">if</span>(r &gt; m) <span class="built_in">update</span>(<span class="built_in">rson</span>(p),l,r,m+<span class="number">1</span>,R,v);</span><br><span class="line">        <span class="built_in">push_up</span>(p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">update</span>(<span class="number">1</span>,l,r,<span class="number">1</span>,n,v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> p,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> L,<span class="type">int</span> R)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l&gt;R || r&lt;L) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(l&lt;=L &amp;&amp; r&gt;=R) <span class="keyword">return</span> tree[p];</span><br><span class="line">        <span class="built_in">push_down</span>(p,L,R);</span><br><span class="line">        <span class="type">int</span> m=(L+R)/<span class="number">2</span>;</span><br><span class="line">        <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(l&lt;=m) res+=<span class="built_in">query</span>(<span class="built_in">lson</span>(p),l,r,L,m);</span><br><span class="line">        <span class="keyword">if</span>(r&gt;m) res+=<span class="built_in">query</span>(<span class="built_in">rson</span>(p),l,r,m+<span class="number">1</span>,R);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">query</span>(<span class="number">1</span>,l,r,<span class="number">1</span>,n);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n,m;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    SegTree::n=n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        cin&gt;&gt;SegTree::dat[i];</span><br><span class="line">    SegTree::<span class="built_in">build</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a;</span><br><span class="line">        cin&gt;&gt;a;</span><br><span class="line">        <span class="keyword">if</span>(a==<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> x,y,k;</span><br><span class="line">            cin&gt;&gt;x&gt;&gt;y&gt;&gt;k;</span><br><span class="line">            SegTree::<span class="built_in">update</span>(x,y,k);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> x,y;</span><br><span class="line">            cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line">            cout&lt;&lt;SegTree::<span class="built_in">query</span>(x,y)&lt;&lt;endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="模版版模版">模版版模版</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Operator&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SegTree</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">SegTree</span>(T *begin, T *end, T _z = <span class="built_in">T</span>()) : <span class="built_in">A</span>(begin), <span class="built_in">one</span>(_z) &#123;</span><br><span class="line">        n = end - begin;</span><br><span class="line">        tree = <span class="keyword">new</span> T[<span class="number">4</span> * n];</span><br><span class="line">        <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> i, T value)</span> </span>&#123; <span class="built_in">update</span>(i, value, <span class="number">1</span>, <span class="number">1</span>, n); &#125;</span><br><span class="line">    <span class="function">T <span class="title">query</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">query</span>(l, r, <span class="number">1</span>, <span class="number">1</span>, n); &#125;</span><br><span class="line">    ~<span class="built_in">SegTree</span>() &#123; <span class="keyword">delete</span>[] tree; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; tree[p] = _oper(tree[_ls(p)], tree[_rs(p)]); &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> L, <span class="type">int</span> R)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (L == R)</span><br><span class="line">            tree[p] = A[L];</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">int</span> m = (L + R) / <span class="number">2</span>;</span><br><span class="line">            <span class="built_in">build</span>(_ls(p), L, m);</span><br><span class="line">            <span class="built_in">build</span>(_rs(p), m + <span class="number">1</span>, R);</span><br><span class="line">            <span class="built_in">merge</span>(p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">T <span class="title">query</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> p, <span class="type">int</span> L, <span class="type">int</span> R)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l &gt; R || r &lt; L)</span><br><span class="line">            <span class="keyword">return</span> one;</span><br><span class="line">        <span class="keyword">if</span> (l &lt;= L &amp;&amp; r &gt;= R) &#123;</span><br><span class="line">            <span class="keyword">return</span> tree[p];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> m = (L + R) / <span class="number">2</span>;</span><br><span class="line">        T ret = one;</span><br><span class="line">        <span class="keyword">if</span> (l &lt;= m)</span><br><span class="line">            ret = _oper(ret, <span class="built_in">query</span>(l, r, _ls(p), L, m));</span><br><span class="line">        <span class="keyword">if</span> (r &gt; m)</span><br><span class="line">            ret = _oper(ret, <span class="built_in">query</span>(l, r, _rs(p), m + <span class="number">1</span>, R));</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> i, T value, <span class="type">int</span> p, <span class="type">int</span> L, <span class="type">int</span> R)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (i &lt; L || i &gt; R)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (L == R) &#123;</span><br><span class="line">            tree[p] = value;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> m = (L + R) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (i &lt;= m)</span><br><span class="line">            <span class="built_in">update</span>(i, value, _ls(p), L, m);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">update</span>(i, value, _rs(p), m + <span class="number">1</span>, R);</span><br><span class="line">        <span class="built_in">merge</span>(p);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">inline</span> <span class="type">int</span> _ls(<span class="type">int</span> p) &#123; <span class="keyword">return</span> <span class="number">2</span> * p; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">inline</span> <span class="type">int</span> _rs(<span class="type">int</span> p) &#123; <span class="keyword">return</span> <span class="number">2</span> * p + <span class="number">1</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line"></span><br><span class="line">    T *tree;</span><br><span class="line"></span><br><span class="line">    T *A;</span><br><span class="line"></span><br><span class="line">    Operator _oper;</span><br><span class="line"></span><br><span class="line">    T one;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="字典树">01-字典树</h2>
<h3 id="模版">模版</h3>
<p><a target="_blank" rel="noopener" href="https://acm.hdu.edu.cn/viewcode.php?rid=36542260">Xor
Sum</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> Trie01</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> trie[<span class="number">33</span> * maxn][<span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> num[<span class="number">33</span> * maxn], cnt = <span class="number">1</span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(trie, <span class="number">0</span>, <span class="built_in">sizeof</span>(trie));</span><br><span class="line">        <span class="built_in">memset</span>(num, <span class="number">0</span>, <span class="built_in">sizeof</span>(num));</span><br><span class="line">        cnt = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> cur = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = max_bit; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> bit = x &gt;&gt; i &amp; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (!trie[cur][bit])</span><br><span class="line">                trie[cur][bit] = ++cnt;</span><br><span class="line">            cur = trie[cur][bit];</span><br><span class="line">        &#125;</span><br><span class="line">        num[cur] = x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">find_xor_max</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> cur = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = max_bit; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> bit = x &gt;&gt; i &amp; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (trie[cur][bit ^ <span class="number">1</span>])</span><br><span class="line">                cur = trie[cur][bit ^ <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                cur = trie[cur][bit];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> num[cur];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="cf1446-xor-tree">CF1446 Xor Tree</h3>
<p>给定你一个序列a<em>a</em>，对于每个<span
class="math inline">\(i\)</span>，它会向序列中的满足<span
class="math inline">\(a_i \oplus a_j\)</span>最小的<span
class="math inline">\(j\)</span>连双向边，并且如果<span
class="math inline">\(j\)</span>也向<span
class="math inline">\(i\)</span>连了边，只算一条边。现在要让你删去序列中的一些数，使得最后形成的图是一颗树，输出最少需要删除几个数。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> max_bit = <span class="number">32</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> A[maxn];</span><br><span class="line"><span class="keyword">namespace</span> Trie01</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> trie[<span class="number">32</span> * maxn][<span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> num[<span class="number">32</span> * maxn], cnt = <span class="number">1</span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(trie, <span class="number">0</span>, <span class="built_in">sizeof</span>(trie));</span><br><span class="line">        <span class="built_in">memset</span>(num, <span class="number">0</span>, <span class="built_in">sizeof</span>(num));</span><br><span class="line">        cnt = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> cur = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = max_bit; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> bit = x &gt;&gt; i &amp; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (!trie[cur][bit])</span><br><span class="line">                trie[cur][bit] = ++cnt;</span><br><span class="line">            cur = trie[cur][bit];</span><br><span class="line">        &#125;</span><br><span class="line">        num[cur] = x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">find_xor_max</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> cur = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = max_bit; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> bit = x &gt;&gt; i &amp; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (trie[cur][bit ^ <span class="number">1</span>])</span><br><span class="line">                cur = trie[cur][bit ^ <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                cur = trie[cur][bit];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> num[cur];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> p = <span class="number">1</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> l = Trie01::trie[p][<span class="number">0</span>], r = Trie01::trie[p][<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span> (!l &amp;&amp; !r)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (!l)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">dfs</span>(r);</span><br><span class="line">    <span class="keyword">if</span> (!r)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">dfs</span>(l);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">max</span>(<span class="built_in">dfs</span>(l), <span class="built_in">dfs</span>(r)) + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; A[i];</span><br><span class="line">        Trie01::<span class="built_in">insert</span>(A[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; n - <span class="built_in">dfs</span>(<span class="number">1</span>) &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="section">388535</h3>
<p><span class="tex-font-style-it">This is the easy version of the
problem. The difference in the constraints between both versions is
colored below in red. You can make hacks only if all versions of the
problem are solved.</span></p>
<p>Marin and Gojou are playing hide-and-seek with an array.</p>
<p>Gojou initially performs the following steps:</p>
<ul>
<li>First, Gojou chooses <span class="math inline">\(2\)</span> integers
<span class="math inline">\(l\)</span> and <span
class="math inline">\(r\)</span> such that <span class="math inline">\(l
\leq r\)</span>.</li>
<li>Then, Gojou makes an array <span class="math inline">\(a\)</span> of
length <span class="math inline">\(r-l+1\)</span> which is a permutation
of the array <span class="math inline">\([l,l+1,\ldots,r]\)</span>.</li>
<li>Finally, Gojou chooses a secret integer <span
class="math inline">\(x\)</span> and sets <span
class="math inline">\(a_i\)</span> to <span class="math inline">\(a_i
\oplus x\)</span> for all <span class="math inline">\(i\)</span> (where
<span class="math inline">\(\oplus\)</span> denotes the
<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Bitwise_operation#XOR">bitwise
XOR operation</a>).</li>
</ul>
<p>Marin is then given the values of <span
class="math inline">\(l,r\)</span> and the final array <span
class="math inline">\(a\)</span>. She needs to find the secret integer
<span class="math inline">\(x\)</span> to win. Can you help her?</p>
<p>Note that there may be multiple possible <span
class="math inline">\(x\)</span> that Gojou could have chosen. Marin can
find any possible <span class="math inline">\(x\)</span> that could have
resulted in the final value of <span
class="math inline">\(a\)</span>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = (<span class="number">1</span> &lt;&lt; <span class="number">17</span>) + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> DS</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> nxt[maxn * <span class="number">18</span>][<span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> num[maxn * <span class="number">18</span>];</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">1</span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        nxt[<span class="number">0</span>][<span class="number">1</span>] = nxt[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        cnt = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> cur = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">20</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> bit = x &gt;&gt; i &amp; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (!nxt[cur][bit])</span><br><span class="line">            &#123;</span><br><span class="line">                nxt[cnt][<span class="number">0</span>] = nxt[cnt][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">                nxt[cur][bit] = cnt++;</span><br><span class="line">            &#125;</span><br><span class="line">            cur = nxt[cur][bit];</span><br><span class="line">        &#125;</span><br><span class="line">        num[cur] = x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">find_max</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> cur = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">20</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> bit = x &gt;&gt; i &amp; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (nxt[cur][bit ^ <span class="number">1</span>])</span><br><span class="line">                cur = nxt[cur][bit ^ <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                cur = nxt[cur][bit];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> num[cur] ^ x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">find_min</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> cur = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">20</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> bit = x &gt;&gt; i &amp; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (nxt[cur][bit])</span><br><span class="line">                cur = nxt[cur][bit];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                cur = nxt[cur][bit ^ <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> num[cur] ^ x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> A[maxn];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DS::<span class="built_in">init</span>();</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= r - l + <span class="number">1</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; A[i];</span><br><span class="line">        DS::<span class="built_in">insert</span>(A[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= r - l + <span class="number">1</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> cur = l ^ A[i];</span><br><span class="line">        <span class="comment">// printf(&quot;%d-&gt;%d,%d\n&quot;, i, DS::find_min(cur), DS::find_max(cur));</span></span><br><span class="line">        <span class="keyword">if</span> (DS::<span class="built_in">find_min</span>(cur) == l &amp;&amp; DS::<span class="built_in">find_max</span>(cur) == r)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; cur &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="number">-1</span> &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> t;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">    <span class="keyword">while</span> (t--)</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>^ <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/174830050">参考 Pecco</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/default-index/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/default-index/">1</a><span class="page-number current">2</span><a class="page-number" href="/default-index/page/3/">3</a><a class="extend next" rel="next" href="/default-index/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Htto"
      src="/images/a1.jpg">
  <p class="site-author-name" itemprop="name">Htto</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">22</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        <div >
  <a href="https://github.com/HttoHu" rel="noopener" target="_blank">Github</a>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

  <script type="text/javascript" src="/js/category.js"></script>
</body>
</html>
